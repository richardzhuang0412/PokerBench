  7%|████████▉                                                                                                                       | 7/100 [00:03<00:23,  4.02it/s]
INFO:     127.0.0.1:51766 - "POST /predict HTTP/1.1" 200 OK
  8%|██████████▏                                                                                                                     | 8/100 [00:03<00:18,  4.88it/s]
INFO:     127.0.0.1:51780 - "POST /predict HTTP/1.1" 200 OK
  9%|███████████▌                                                                                                                    | 9/100 [00:03<00:17,  5.14it/s]
INFO:     127.0.0.1:51784 - "POST /predict HTTP/1.1" 200 OK
 10%|████████████▋                                                                                                                  | 10/100 [00:03<00:17,  5.23it/s]
INFO:     127.0.0.1:51794 - "POST /predict HTTP/1.1" 200 OK
 11%|█████████████▉                                                                                                                 | 11/100 [00:03<00:18,  4.92it/s]
INFO:     127.0.0.1:51804 - "POST /predict HTTP/1.1" 200 OK
 12%|███████████████▏                                                                                                               | 12/100 [00:04<00:15,  5.55it/s]
INFO:     127.0.0.1:51808 - "POST /predict HTTP/1.1" 200 OK
 13%|████████████████▌                                                                                                              | 13/100 [00:04<00:14,  6.08it/s]
INFO:     127.0.0.1:51824 - "POST /predict HTTP/1.1" 200 OK
 14%|█████████████████▊                                                                                                             | 14/100 [00:04<00:17,  4.90it/s]
INFO:     127.0.0.1:51836 - "POST /predict HTTP/1.1" 200 OK
 15%|███████████████████                                                                                                            | 15/100 [00:04<00:17,  4.88it/s]
INFO:     127.0.0.1:51838 - "POST /predict HTTP/1.1" 200 OK
 16%|████████████████████▎                                                                                                          | 16/100 [00:04<00:16,  5.02it/s]
INFO:     127.0.0.1:51844 - "POST /predict HTTP/1.1" 200 OK
 17%|█████████████████████▌                                                                                                         | 17/100 [00:05<00:20,  3.98it/s]
INFO:     127.0.0.1:51860 - "POST /predict HTTP/1.1" 200 OK
 18%|██████████████████████▊                                                                                                        | 18/100 [00:05<00:17,  4.78it/s]
INFO:     127.0.0.1:51868 - "POST /predict HTTP/1.1" 200 OK
 19%|████████████████████████▏                                                                                                      | 19/100 [00:05<00:16,  4.89it/s]
INFO:     127.0.0.1:51876 - "POST /predict HTTP/1.1" 200 OK
 20%|█████████████████████████▍                                                                                                     | 20/100 [00:06<00:23,  3.47it/s]
INFO:     127.0.0.1:51880 - "POST /predict HTTP/1.1" 200 OK
 21%|██████████████████████████▋                                                                                                    | 21/100 [00:06<00:20,  3.88it/s]
INFO:     127.0.0.1:51884 - "POST /predict HTTP/1.1" 200 OK
 22%|███████████████████████████▉                                                                                                   | 22/100 [00:06<00:17,  4.56it/s]
INFO:     127.0.0.1:51892 - "POST /predict HTTP/1.1" 200 OK
 23%|█████████████████████████████▏                                                                                                 | 23/100 [00:06<00:15,  4.82it/s]
INFO:     127.0.0.1:51898 - "POST /predict HTTP/1.1" 200 OK
 24%|██████████████████████████████▍                                                                                                | 24/100 [00:06<00:13,  5.55it/s]
INFO:     127.0.0.1:51904 - "POST /predict HTTP/1.1" 200 OK
 25%|███████████████████████████████▊                                                                                               | 25/100 [00:06<00:12,  6.08it/s]
INFO:     127.0.0.1:51920 - "POST /predict HTTP/1.1" 200 OK
 26%|█████████████████████████████████                                                                                              | 26/100 [00:06<00:12,  5.81it/s]
INFO:     127.0.0.1:51926 - "POST /predict HTTP/1.1" 200 OK
 27%|██████████████████████████████████▎                                                                                            | 27/100 [00:07<00:11,  6.40it/s]
INFO:     127.0.0.1:51938 - "POST /predict HTTP/1.1" 200 OK
 28%|███████████████████████████████████▌                                                                                           | 28/100 [00:07<00:10,  6.92it/s]
INFO:     127.0.0.1:51952 - "POST /predict HTTP/1.1" 200 OK
 29%|████████████████████████████████████▊                                                                                          | 29/100 [00:07<00:09,  7.35it/s]
INFO:     127.0.0.1:51960 - "POST /predict HTTP/1.1" 200 OK
 30%|██████████████████████████████████████                                                                                         | 30/100 [00:07<00:09,  7.51it/s]
INFO:     127.0.0.1:51970 - "POST /predict HTTP/1.1" 200 OK
 31%|███████████████████████████████████████▎                                                                                       | 31/100 [00:07<00:08,  7.73it/s]
INFO:     127.0.0.1:51978 - "POST /predict HTTP/1.1" 200 OK
 32%|████████████████████████████████████████▋                                                                                      | 32/100 [00:07<00:08,  8.17it/s]
INFO:     127.0.0.1:51980 - "POST /predict HTTP/1.1" 200 OK
 33%|█████████████████████████████████████████▉                                                                                     | 33/100 [00:07<00:08,  7.86it/s]
INFO:     127.0.0.1:51990 - "POST /predict HTTP/1.1" 200 OK
 34%|███████████████████████████████████████████▏                                                                                   | 34/100 [00:08<00:10,  6.45it/s]
INFO:     127.0.0.1:51994 - "POST /predict HTTP/1.1" 200 OK
 35%|████████████████████████████████████████████▍                                                                                  | 35/100 [00:08<00:10,  6.11it/s]
INFO:     127.0.0.1:51996 - "POST /predict HTTP/1.1" 200 OK
 36%|█████████████████████████████████████████████▋                                                                                 | 36/100 [00:08<00:10,  6.00it/s]
INFO:     127.0.0.1:52000 - "POST /predict HTTP/1.1" 200 OK
 37%|██████████████████████████████████████████████▉                                                                                | 37/100 [00:08<00:10,  5.79it/s]
INFO:     127.0.0.1:52006 - "POST /predict HTTP/1.1" 200 OK
 38%|████████████████████████████████████████████████▎                                                                              | 38/100 [00:08<00:10,  5.72it/s]
INFO:     127.0.0.1:52022 - "POST /predict HTTP/1.1" 200 OK
 39%|█████████████████████████████████████████████████▌                                                                             | 39/100 [00:08<00:11,  5.12it/s]
INFO:     127.0.0.1:52032 - "POST /predict HTTP/1.1" 200 OK
 40%|██████████████████████████████████████████████████▊                                                                            | 40/100 [00:09<00:11,  5.41it/s]
INFO:     127.0.0.1:52042 - "POST /predict HTTP/1.1" 200 OK
 41%|████████████████████████████████████████████████████                                                                           | 41/100 [00:09<00:11,  5.12it/s]
INFO:     127.0.0.1:52048 - "POST /predict HTTP/1.1" 200 OK
 42%|█████████████████████████████████████████████████████▎                                                                         | 42/100 [00:09<00:10,  5.77it/s]
INFO:     127.0.0.1:52054 - "POST /predict HTTP/1.1" 200 OK
 43%|██████████████████████████████████████████████████████▌                                                                        | 43/100 [00:09<00:10,  5.43it/s]
INFO:     127.0.0.1:52066 - "POST /predict HTTP/1.1" 200 OK
 44%|███████████████████████████████████████████████████████▉                                                                       | 44/100 [00:09<00:09,  6.08it/s]
INFO:     127.0.0.1:52082 - "POST /predict HTTP/1.1" 200 OK
 45%|█████████████████████████████████████████████████████████▏                                                                     | 45/100 [00:09<00:08,  6.65it/s]
INFO:     127.0.0.1:52084 - "POST /predict HTTP/1.1" 200 OK
 46%|██████████████████████████████████████████████████████████▍                                                                    | 46/100 [00:10<00:07,  7.06it/s]
INFO:     127.0.0.1:52090 - "POST /predict HTTP/1.1" 200 OK
 47%|███████████████████████████████████████████████████████████▋                                                                   | 47/100 [00:10<00:12,  4.11it/s]
INFO:     127.0.0.1:52098 - "POST /predict HTTP/1.1" 200 OK
 48%|████████████████████████████████████████████████████████████▉                                                                  | 48/100 [00:10<00:11,  4.45it/s]
INFO:     127.0.0.1:52108 - "POST /predict HTTP/1.1" 200 OK
 49%|██████████████████████████████████████████████████████████████▏                                                                | 49/100 [00:10<00:10,  5.04it/s]
INFO:     127.0.0.1:52122 - "POST /predict HTTP/1.1" 200 OK
 50%|███████████████████████████████████████████████████████████████▌                                                               | 50/100 [00:11<00:09,  5.11it/s]
INFO:     127.0.0.1:52138 - "POST /predict HTTP/1.1" 200 OK
 51%|████████████████████████████████████████████████████████████████▊                                                              | 51/100 [00:11<00:09,  4.98it/s]
INFO:     127.0.0.1:52146 - "POST /predict HTTP/1.1" 200 OK
 52%|██████████████████████████████████████████████████████████████████                                                             | 52/100 [00:11<00:09,  4.91it/s]
INFO:     127.0.0.1:43600 - "POST /predict HTTP/1.1" 200 OK
 53%|███████████████████████████████████████████████████████████████████▎                                                           | 53/100 [00:11<00:09,  4.90it/s]
INFO:     127.0.0.1:43614 - "POST /predict HTTP/1.1" 200 OK
 54%|████████████████████████████████████████████████████████████████████▌                                                          | 54/100 [00:11<00:09,  4.90it/s]
INFO:     127.0.0.1:43620 - "POST /predict HTTP/1.1" 200 OK
 55%|█████████████████████████████████████████████████████████████████████▊                                                         | 55/100 [00:12<00:09,  4.61it/s]
INFO:     127.0.0.1:43624 - "POST /predict HTTP/1.1" 200 OK
 56%|███████████████████████████████████████████████████████████████████████                                                        | 56/100 [00:12<00:09,  4.42it/s]
INFO:     127.0.0.1:43638 - "POST /predict HTTP/1.1" 200 OK
 57%|████████████████████████████████████████████████████████████████████████▍                                                      | 57/100 [00:12<00:09,  4.39it/s]
INFO:     127.0.0.1:43648 - "POST /predict HTTP/1.1" 200 OK
 58%|█████████████████████████████████████████████████████████████████████████▋                                                     | 58/100 [00:12<00:09,  4.29it/s]
INFO:     127.0.0.1:43654 - "POST /predict HTTP/1.1" 200 OK
 59%|██████████████████████████████████████████████████████████████████████████▉                                                    | 59/100 [00:13<00:09,  4.11it/s]
INFO:     127.0.0.1:43662 - "POST /predict HTTP/1.1" 200 OK
 60%|████████████████████████████████████████████████████████████████████████████▏                                                  | 60/100 [00:13<00:12,  3.10it/s]
INFO:     127.0.0.1:43664 - "POST /predict HTTP/1.1" 200 OK
 61%|█████████████████████████████████████████████████████████████████████████████▍                                                 | 61/100 [00:13<00:11,  3.33it/s]
INFO:     127.0.0.1:43678 - "POST /predict HTTP/1.1" 200 OK
 62%|██████████████████████████████████████████████████████████████████████████████▋                                                | 62/100 [00:14<00:11,  3.45it/s]
INFO:     127.0.0.1:43692 - "POST /predict HTTP/1.1" 200 OK
 63%|████████████████████████████████████████████████████████████████████████████████                                               | 63/100 [00:14<00:10,  3.64it/s]
INFO:     127.0.0.1:43706 - "POST /predict HTTP/1.1" 200 OK
 64%|█████████████████████████████████████████████████████████████████████████████████▎                                             | 64/100 [00:14<00:09,  3.70it/s]
INFO:     127.0.0.1:43718 - "POST /predict HTTP/1.1" 200 OK
 65%|██████████████████████████████████████████████████████████████████████████████████▌                                            | 65/100 [00:14<00:09,  3.76it/s]
INFO:     127.0.0.1:43734 - "POST /predict HTTP/1.1" 200 OK
 66%|███████████████████████████████████████████████████████████████████████████████████▊                                           | 66/100 [00:15<00:08,  3.95it/s]
INFO:     127.0.0.1:43742 - "POST /predict HTTP/1.1" 200 OK
 67%|█████████████████████████████████████████████████████████████████████████████████████                                          | 67/100 [00:15<00:08,  4.08it/s]
INFO:     127.0.0.1:43750 - "POST /predict HTTP/1.1" 200 OK
 68%|██████████████████████████████████████████████████████████████████████████████████████▎                                        | 68/100 [00:15<00:07,  4.20it/s]
INFO:     127.0.0.1:43756 - "POST /predict HTTP/1.1" 200 OK
 69%|███████████████████████████████████████████████████████████████████████████████████████▋                                       | 69/100 [00:15<00:07,  4.24it/s]
INFO:     127.0.0.1:43758 - "POST /predict HTTP/1.1" 200 OK
 70%|████████████████████████████████████████████████████████████████████████████████████████▉                                      | 70/100 [00:15<00:06,  4.64it/s]
INFO:     127.0.0.1:43766 - "POST /predict HTTP/1.1" 200 OK
 71%|██████████████████████████████████████████████████████████████████████████████████████████▏                                    | 71/100 [00:16<00:06,  4.71it/s]
INFO:     127.0.0.1:43772 - "POST /predict HTTP/1.1" 200 OK
 72%|███████████████████████████████████████████████████████████████████████████████████████████▍                                   | 72/100 [00:16<00:05,  4.69it/s]
INFO:     127.0.0.1:43774 - "POST /predict HTTP/1.1" 200 OK
 73%|████████████████████████████████████████████████████████████████████████████████████████████▋                                  | 73/100 [00:16<00:05,  4.64it/s]
INFO:     127.0.0.1:43784 - "POST /predict HTTP/1.1" 200 OK
 74%|█████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 74/100 [00:16<00:05,  4.66it/s]
INFO:     127.0.0.1:43794 - "POST /predict HTTP/1.1" 200 OK
 75%|███████████████████████████████████████████████████████████████████████████████████████████████▎                               | 75/100 [00:17<00:05,  4.57it/s]
INFO:     127.0.0.1:43798 - "POST /predict HTTP/1.1" 200 OK
 76%|████████████████████████████████████████████████████████████████████████████████████████████████▌                              | 76/100 [00:17<00:05,  4.53it/s]
INFO:     127.0.0.1:43810 - "POST /predict HTTP/1.1" 200 OK
 77%|█████████████████████████████████████████████████████████████████████████████████████████████████▊                             | 77/100 [00:17<00:05,  4.58it/s]
INFO:     127.0.0.1:43826 - "POST /predict HTTP/1.1" 200 OK
 78%|███████████████████████████████████████████████████████████████████████████████████████████████████                            | 78/100 [00:17<00:04,  4.95it/s]
INFO:     127.0.0.1:43828 - "POST /predict HTTP/1.1" 200 OK
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████▎                          | 79/100 [00:17<00:04,  4.89it/s]
INFO:     127.0.0.1:43844 - "POST /predict HTTP/1.1" 200 OK
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████▌                         | 80/100 [00:18<00:04,  4.72it/s]
INFO:     127.0.0.1:43850 - "POST /predict HTTP/1.1" 200 OK
 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                        | 81/100 [00:18<00:04,  4.74it/s]
INFO:     127.0.0.1:43862 - "POST /predict HTTP/1.1" 200 OK
 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████▏                      | 82/100 [00:18<00:03,  4.72it/s]
INFO:     127.0.0.1:43872 - "POST /predict HTTP/1.1" 200 OK
 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▍                     | 83/100 [00:18<00:03,  4.60it/s]
INFO:     127.0.0.1:43884 - "POST /predict HTTP/1.1" 200 OK
 84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▋                    | 84/100 [00:18<00:03,  4.57it/s]
INFO:     127.0.0.1:43892 - "POST /predict HTTP/1.1" 200 OK
 85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                   | 85/100 [00:19<00:03,  4.48it/s]
INFO:     127.0.0.1:43902 - "POST /predict HTTP/1.1" 200 OK
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 86/100 [00:19<00:03,  4.56it/s]
INFO:     127.0.0.1:43914 - "POST /predict HTTP/1.1" 200 OK
 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 87/100 [00:19<00:03,  3.29it/s]
INFO:     127.0.0.1:43928 - "POST /predict HTTP/1.1" 200 OK
 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊               | 88/100 [00:20<00:03,  3.55it/s]
INFO:     127.0.0.1:43934 - "POST /predict HTTP/1.1" 200 OK
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 89/100 [00:20<00:02,  3.79it/s]
INFO:     127.0.0.1:43944 - "POST /predict HTTP/1.1" 200 OK
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 90/100 [00:20<00:03,  2.96it/s]
INFO:     127.0.0.1:43950 - "POST /predict HTTP/1.1" 200 OK
 91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 91/100 [00:21<00:02,  3.38it/s]
INFO:     127.0.0.1:43954 - "POST /predict HTTP/1.1" 200 OK
 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊          | 92/100 [00:21<00:02,  2.72it/s]
INFO:     127.0.0.1:33068 - "POST /predict HTTP/1.1" 200 OK
 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████         | 93/100 [00:21<00:02,  3.05it/s]
INFO:     127.0.0.1:33072 - "POST /predict HTTP/1.1" 200 OK
 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 94/100 [00:22<00:01,  3.35it/s]
INFO:     127.0.0.1:33088 - "POST /predict HTTP/1.1" 200 OK
 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 95/100 [00:22<00:01,  2.68it/s]
INFO:     127.0.0.1:33096 - "POST /predict HTTP/1.1" 200 OK
 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 96/100 [00:22<00:01,  3.17it/s]
INFO:     127.0.0.1:33110 - "POST /predict HTTP/1.1" 200 OK
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏   | 97/100 [00:22<00:00,  3.63it/s]
INFO:     127.0.0.1:33118 - "POST /predict HTTP/1.1" 200 OK
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍  | 98/100 [00:23<00:00,  4.07it/s]
INFO:     127.0.0.1:33122 - "POST /predict HTTP/1.1" 200 OK
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 99/100 [00:23<00:00,  4.41it/s]
INFO:     127.0.0.1:33134 - "POST /predict HTTP/1.1" 200 OK
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:23<00:00,  4.26it/s]
Accuracy of step-000700 on Eval Dataset: 0.61
Processes on GPU 7: [218929]
Terminated process with PID: 218929 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
python    218900 richard    4u  IPv4  993116      0t0  TCP localhost:33134->localhost:8000 (ESTABLISHED)
pt_main_t 218902 richard  243u  IPv4 1223824      0t0  TCP *:8000 (LISTEN)
pt_main_t 218902 richard  253u  IPv4 1041106      0t0  TCP localhost:8000->localhost:33134 (ESTABLISHED)

Port Process 218902 Killed
COMMAND    PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
python  218900 richard    4u  IPv4 993116      0t0  TCP localhost:33134->localhost:8000 (CLOSE_WAIT)

COMMAND    PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
python  218900 richard    4u  IPv4 993116      0t0  TCP localhost:33134->localhost:8000 (CLOSE_WAIT)

COMMAND    PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
python  218900 richard    4u  IPv4 993116      0t0  TCP localhost:33134->localhost:8000 (CLOSE_WAIT)

COMMAND    PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
python  218900 richard    4u  IPv4 993116      0t0  TCP localhost:33134->localhost:8000 (CLOSE_WAIT)

COMMAND    PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
python  218900 richard    4u  IPv4 993116      0t0  TCP localhost:33134->localhost:8000 (CLOSE_WAIT)

COMMAND    PID    USER   FD   TYPE DEVICE SIZE/OFF NODE NAME
python  218900 richard    4u  IPv4 993116      0t0  TCP localhost:33134->localhost:8000 (CLOSE_WAIT)

^CTraceback (most recent call last):
  File "/data/richard/poker_llm/evaluate.py", line 147, in <module>
    time.sleep(5)
KeyboardInterrupt

(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » litgpt serve --checkpoint_dir out/llama-2-base-ft/step-000050 --temperature 0.2 --max_new_tokens 50                         130 ↵ richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » nvidia-smi                                                                                                                  130 ↵ richard@sn4622117596
Sat May 25 16:18:02 2024
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.06              Driver Version: 545.23.06    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100 80GB PCIe          On  | 00000000:4F:00.0 Off |                    0 |
| N/A   31C    P0              75W / 300W |  44267MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100 80GB PCIe          On  | 00000000:52:00.0 Off |                    0 |
| N/A   33C    P0              75W / 300W |  50639MiB / 81920MiB |    100%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100 80GB PCIe          On  | 00000000:56:00.0 Off |                    0 |
| N/A   28C    P0              54W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100 80GB PCIe          On  | 00000000:57:00.0 Off |                    0 |
| N/A   30C    P0              51W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA A100 80GB PCIe          On  | 00000000:D1:00.0 Off |                    0 |
| N/A   28C    P0              52W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA A100 80GB PCIe          On  | 00000000:D2:00.0 Off |                    0 |
| N/A   30C    P0              52W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA A100 80GB PCIe          On  | 00000000:D5:00.0 Off |                    0 |
| N/A   32C    P0              53W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA A100 80GB PCIe          On  | 00000000:D6:00.0 Off |                    0 |
| N/A   29C    P0              53W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+

+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|    0   N/A  N/A     45833      C   ...d/miniconda3/envs/litgpt/bin/python    44254MiB |
|    1   N/A  N/A     45858      C   ...d/miniconda3/envs/litgpt/bin/python    50626MiB |
+---------------------------------------------------------------------------------------+
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » lsof -i :8000                                                                                                                     richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python kill_port_process.py                                                                                                   1 ↵ richard@sn4622117596
Iteration 1/10
Started server with PID: 220675
Server is not responding as expected. Status code: 404
Terminated process tree for PID: 220675
Error terminating processes on GPU 7 for user richard: Command '['nvidia-smi', '--id=7', '--query-compute-apps=pid,username', '--format=csv,noheader']' returned non-
zero exit status 2.
Iteration 2/10
Started server with PID: 220912
Server is not responding as expected. Status code: 404
Terminated process tree for PID: 220912
Error terminating processes on GPU 7 for user richard: Command '['nvidia-smi', '--id=7', '--query-compute-apps=pid,username', '--format=csv,noheader']' returned non-
zero exit status 2.
Iteration 3/10
Started server with PID: 221148
Server is not responding as expected. Status code: 404
^CTraceback (most recent call last):
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_psposix.py", line 130, in wait_pid
    retpid, status = os.waitpid(pid, flags)
                     ^^^^^^^^^^^^^^^^^^^^^^
ChildProcessError: [Errno 10] No child processes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/richard/poker_llm/kill_port_process.py", line 67, in <module>
    terminate_process_tree(process.pid)
  File "/data/richard/poker_llm/kill_port_process.py", line 31, in terminate_process_tree
    _, still_alive = psutil.wait_procs(children, timeout=5)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/__init__.py", line 1615, in wait_procs
    check_gone(proc, timeout)
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/__init__.py", line 1576, in check_gone
    returncode = proc.wait(timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/__init__.py", line 1325, in wait
    self._exitcode = self._proc.wait(timeout)
                     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_pslinux.py", line 1714, in wrapper
    return fun(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_pslinux.py", line 1941, in wait
    return _psposix.wait_pid(self.pid, timeout, self._name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_psposix.py", line 141, in wait_pid
    interval = sleep(interval)
               ^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_psposix.py", line 124, in sleep
    _sleep(interval)
KeyboardInterrupt

(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm »                                                                                                                             130 ↵ richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » lsof -i :8000                                                                                                               130 ↵ richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » nvidia-smi                                                                                                                    1 ↵ richard@sn4622117596
Sat May 25 16:19:54 2024
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.06              Driver Version: 545.23.06    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100 80GB PCIe          On  | 00000000:4F:00.0 Off |                    0 |
| N/A   54C    P0             338W / 300W |  80753MiB / 81920MiB |    100%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100 80GB PCIe          On  | 00000000:52:00.0 Off |                    0 |
| N/A   55C    P0             308W / 300W |  78285MiB / 81920MiB |    100%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100 80GB PCIe          On  | 00000000:56:00.0 Off |                    0 |
| N/A   29C    P0              54W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100 80GB PCIe          On  | 00000000:57:00.0 Off |                    0 |
| N/A   31C    P0              52W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA A100 80GB PCIe          On  | 00000000:D1:00.0 Off |                    0 |
| N/A   29C    P0              52W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA A100 80GB PCIe          On  | 00000000:D2:00.0 Off |                    0 |
| N/A   31C    P0              53W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA A100 80GB PCIe          On  | 00000000:D5:00.0 Off |                    0 |
| N/A   32C    P0              54W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA A100 80GB PCIe          On  | 00000000:D6:00.0 Off |                    0 |
| N/A   32C    P0              74W / 300W |  15459MiB / 81920MiB |      2%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+

+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|    0   N/A  N/A     45833      C   ...d/miniconda3/envs/litgpt/bin/python    78638MiB |
|    1   N/A  N/A     45858      C   ...d/miniconda3/envs/litgpt/bin/python    78660MiB |
|    7   N/A  N/A    221266      C   ...d/miniconda3/envs/litgpt/bin/python    15446MiB |
+---------------------------------------------------------------------------------------+
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » kill -9 221266                                                                                                                    richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python kill_port_process.py                                                                                                       richard@sn4622117596
Iteration 1/10
Started server with PID: 221563
INFO:     Started server process [221564]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     127.0.0.1:45180 - "GET /status HTTP/1.1" 404 Not Found
Server is not responding as expected. Status code: 404
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [221564]
Terminated process tree for PID: 221563
Error terminating processes on GPU 7 for user richard: Command '['nvidia-smi', '--id=7', '--query-compute-apps=pid,username', '--format=csv,noheader']' returned non-
zero exit status 2.
Iteration 2/10
Started server with PID: 221773
INFO:     Started server process [221774]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     127.0.0.1:53616 - "GET /status HTTP/1.1" 404 Not Found
Server is not responding as expected. Status code: 404
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [221774]
^CTraceback (most recent call last):
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_psposix.py", line 130, in wait_pid
    retpid, status = os.waitpid(pid, flags)
                     ^^^^^^^^^^^^^^^^^^^^^^
ChildProcessError: [Errno 10] No child processes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/richard/poker_llm/kill_port_process.py", line 67, in <module>
    terminate_process_tree(process.pid)
  File "/data/richard/poker_llm/kill_port_process.py", line 31, in terminate_process_tree
    _, still_alive = psutil.wait_procs(children, timeout=5)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/__init__.py", line 1615, in wait_procs
    check_gone(proc, timeout)
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/__init__.py", line 1576, in check_gone
    returncode = proc.wait(timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/__init__.py", line 1325, in wait
    self._exitcode = self._proc.wait(timeout)
                     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_pslinux.py", line 1714, in wrapper
    return fun(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_pslinux.py", line 1941, in wait
    return _psposix.wait_pid(self.pid, timeout, self._name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_psposix.py", line 141, in wait_pid
    interval = sleep(interval)
               ^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_psposix.py", line 124, in sleep
    _sleep(interval)
KeyboardInterrupt

(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm »                                                                                                                             130 ↵ richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python kill_port_process.py                                                                                                 130 ↵ richard@sn4622117596
Iteration 1/10
Started server with PID: 222140
INFO:     Started server process [222141]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     127.0.0.1:41382 - "GET /status HTTP/1.1" 404 Not Found
Server is not responding as expected. Status code: 404
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [222141]
Terminated process tree for PID: 222140
Error terminating processes on GPU 7 for user richard: Command '['nvidia-smi', '--id=7', '--query-compute-apps=pid,username', '--format=csv,noheader']' returned non-
zero exit status 2.
Iteration 2/10
Started server with PID: 222314
INFO:     Started server process [222315]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     127.0.0.1:34646 - "GET /status HTTP/1.1" 404 Not Found
Server is not responding as expected. Status code: 404
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [222315]
^CTraceback (most recent call last):
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_psposix.py", line 130, in wait_pid
    retpid, status = os.waitpid(pid, flags)
                     ^^^^^^^^^^^^^^^^^^^^^^
ChildProcessError: [Errno 10] No child processes

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/richard/poker_llm/kill_port_process.py", line 67, in <module>
    terminate_process_tree(process.pid)
  File "/data/richard/poker_llm/kill_port_process.py", line 31, in terminate_process_tree
    _, still_alive = psutil.wait_procs(children, timeout=5)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/__init__.py", line 1615, in wait_procs
    check_gone(proc, timeout)
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/__init__.py", line 1576, in check_gone
    returncode = proc.wait(timeout=timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/__init__.py", line 1325, in wait
    self._exitcode = self._proc.wait(timeout)
                     ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_pslinux.py", line 1714, in wrapper
    return fun(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_pslinux.py", line 1941, in wait
    return _psposix.wait_pid(self.pid, timeout, self._name)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_psposix.py", line 141, in wait_pid
    interval = sleep(interval)
               ^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/psutil/_psposix.py", line 124, in sleep
    _sleep(interval)
KeyboardInterrupt

(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm »                                                                                                                             130 ↵ richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » nvidia-smi                                                                                                                  130 ↵ richard@sn4622117596
Sat May 25 16:22:26 2024
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.06              Driver Version: 545.23.06    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100 80GB PCIe          On  | 00000000:4F:00.0 Off |                    0 |
| N/A   73C    P0             334W / 300W |  79567MiB / 81920MiB |    100%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100 80GB PCIe          On  | 00000000:52:00.0 Off |                    0 |
| N/A   76C    P0             317W / 300W |  74371MiB / 81920MiB |    100%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100 80GB PCIe          On  | 00000000:56:00.0 Off |                    0 |
| N/A   30C    P0              54W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100 80GB PCIe          On  | 00000000:57:00.0 Off |                    0 |
| N/A   31C    P0              52W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA A100 80GB PCIe          On  | 00000000:D1:00.0 Off |                    0 |
| N/A   30C    P0              52W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA A100 80GB PCIe          On  | 00000000:D2:00.0 Off |                    0 |
| N/A   32C    P0              53W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA A100 80GB PCIe          On  | 00000000:D5:00.0 Off |                    0 |
| N/A   33C    P0              54W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA A100 80GB PCIe          On  | 00000000:D6:00.0 Off |                    0 |
| N/A   34C    P0              76W / 300W |  30911MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+

+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|    0   N/A  N/A     45833      C   ...d/miniconda3/envs/litgpt/bin/python    80330MiB |
|    1   N/A  N/A     45858      C   ...d/miniconda3/envs/litgpt/bin/python    75134MiB |
|    7   N/A  N/A    221801      C   ...d/miniconda3/envs/litgpt/bin/python    15446MiB |
|    7   N/A  N/A    222349      C   ...d/miniconda3/envs/litgpt/bin/python    15446MiB |
+---------------------------------------------------------------------------------------+
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » kill -9 221801                                                                                                                    richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » kill -9 222349                                                                                                                    richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » lsof -i :8000                                                                                                                     richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python evaluate_all.py                                                                                                        1 ↵ richard@sn4622117596
['step-000700', 'step-000750', 'step-000800', 'step-000850', 'step-000900', 'step-000950', 'step-0001000', 'step-0001050', 'step-0001100', 'step-0001150', 'step-0001
200', 'step-0001250', 'step-0001300', 'step-0001350', 'step-0001400', 'step-0001450', 'step-0001500', 'step-0001550', 'step-0001600', 'step-0001650', 'step-0001700',
 'step-0001750', 'step-0001800', 'step-0001850', 'step-0001900', 'step-0001950', 'step-0002000', 'step-0002050', 'step-0002100', 'step-0002150', 'step-0002200', 'ste
p-0002250', 'step-0002300', 'step-0002350', 'step-0002400', 'step-0002450', 'step-0002500', 'step-0002550', 'step-0002600', 'step-0002650', 'step-0002700']
Evaluating step-000700
INFO:     Started server process [224179]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
usage: evaluate.py [-h] model_path
evaluate.py: error: unrecognized arguments: --model_path
Traceback (most recent call last):
  File "/data/richard/poker_llm/evaluate_all.py", line 63, in <module>
    process.terminate()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'CompletedProcess' object has no attribute 'terminate'
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python evaluate_all.py                                                                                                        1 ↵ richard@sn4622117596
['step-000700', 'step-000750', 'step-000800', 'step-000850', 'step-000900', 'step-000950', 'step-0001000', 'step-0001050', 'step-0001100', 'step-0001150', 'step-0001
200', 'step-0001250', 'step-0001300', 'step-0001350', 'step-0001400', 'step-0001450', 'step-0001500', 'step-0001550', 'step-0001600', 'step-0001650', 'step-0001700',
 'step-0001750', 'step-0001800', 'step-0001850', 'step-0001900', 'step-0001950', 'step-0002000', 'step-0002050', 'step-0002100', 'step-0002150', 'step-0002200', 'ste
p-0002250', 'step-0002300', 'step-0002350', 'step-0002400', 'step-0002450', 'step-0002500', 'step-0002550', 'step-0002600', 'step-0002650', 'step-0002700']
Evaluating step-000700
INFO:     Started server process [224372]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
usage: evaluate.py [-h] model_path
evaluate.py: error: unrecognized arguments: --model_path
Traceback (most recent call last):
  File "/data/richard/poker_llm/evaluate_all.py", line 63, in <module>
    process.terminate()
    ^^^^^^^
NameError: name 'process' is not defined. Did you mean: 'subprocess'?
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python evaluate_all.py                                                                                                        1 ↵ richard@sn4622117596
['step-000700', 'step-000750', 'step-000800', 'step-000850', 'step-000900', 'step-000950', 'step-0001000', 'step-0001050', 'step-0001100', 'step-0001150', 'step-0001
200', 'step-0001250', 'step-0001300', 'step-0001350', 'step-0001400', 'step-0001450', 'step-0001500', 'step-0001550', 'step-0001600', 'step-0001650', 'step-0001700',
 'step-0001750', 'step-0001800', 'step-0001850', 'step-0001900', 'step-0001950', 'step-0002000', 'step-0002050', 'step-0002100', 'step-0002150', 'step-0002200', 'ste
p-0002250', 'step-0002300', 'step-0002350', 'step-0002400', 'step-0002450', 'step-0002500', 'step-0002550', 'step-0002600', 'step-0002650', 'step-0002700']
Evaluating step-000700
INFO:     Started server process [224558]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
usage: evaluate.py [-h] model_path
evaluate.py: error: unrecognized arguments: --model_path
Traceback (most recent call last):
  File "/data/richard/poker_llm/evaluate_all.py", line 23, in <module>
    eval_process.wait()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'CompletedProcess' object has no attribute 'wait'
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python evaluate_all.py                                                                                                        1 ↵ richard@sn4622117596
['step-000700', 'step-000750', 'step-000800', 'step-000850', 'step-000900', 'step-000950', 'step-0001000', 'step-0001050', 'step-0001100', 'step-0001150', 'step-0001
200', 'step-0001250', 'step-0001300', 'step-0001350', 'step-0001400', 'step-0001450', 'step-0001500', 'step-0001550', 'step-0001600', 'step-0001650', 'step-0001700',
 'step-0001750', 'step-0001800', 'step-0001850', 'step-0001900', 'step-0001950', 'step-0002000', 'step-0002050', 'step-0002100', 'step-0002150', 'step-0002200', 'ste
p-0002250', 'step-0002300', 'step-0002350', 'step-0002400', 'step-0002450', 'step-0002500', 'step-0002550', 'step-0002600', 'step-0002650', 'step-0002700']
Evaluating step-000700
INFO:     Started server process [224752]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
ERROR:    [Errno 98] error while attempting to bind on address ('0.0.0.0', 8000): address already in use
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
usage: evaluate.py [-h] model_path
evaluate.py: error: unrecognized arguments: --model_path
Processes on GPU 7: [224207, 224400, 224595, 224794]
Terminated process with PID: 224207 owned by richard
Terminated process with PID: 224400 owned by richard
Terminated process with PID: 224595 owned by richard
Terminated process with PID: 224794 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 224179 richard  243u  IPv4 1225366      0t0  TCP *:8000 (LISTEN)

Port Process 224179 Killed
Killed

Evaluating step-000750
INFO:     Started server process [224944]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
usage: evaluate.py [-h] model_path
evaluate.py: error: unrecognized arguments: --model_path
Processes on GPU 7: [224961]
Terminated process with PID: 224961 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 224944 richard  243u  IPv4 1599858      0t0  TCP *:8000 (LISTEN)

Port Process 224944 Killed

Evaluating step-000800
^CTraceback (most recent call last):
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/__init__.py", line 3070, in _dep_map
Traceback (most recent call last):
  File "/data/richard/poker_llm/evaluate_all.py", line 20, in <module>
    time.sleep(15)
KeyboardInterrupt
    return self.__dep_map
           ^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/__init__.py", line 2863, in __getattr__
    raise AttributeError(attr)
AttributeError: _DistInfoDistribution__dep_map

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/richard/miniconda3/envs/litgpt/bin/litgpt", line 5, in <module>
    from litgpt.__main__ import main
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/litgpt/__init__.py", line 6, in <module>
    from litgpt.model import GPT  # needs to be imported before config
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/litgpt/model.py", line 16, in <module>
    from litgpt.config import Config
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/litgpt/config.py", line 13, in <module>
    from litgpt.utils import find_multiple
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/litgpt/utils.py", line 15, in <module>
    import lightning as L
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/lightning/__init__.py", line 21, in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/lightning/pytorch/__init__.py", line 27, in <module>
    from lightning.pytorch.callbacks import Callback  # noqa: E402
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/lightning/pytorch/callbacks/__init__.py", line 14, in <module>
    from lightning.pytorch.callbacks.batch_size_finder import BatchSizeFinder
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/lightning/pytorch/callbacks/batch_size_finder.py", line 26, in <module>
    from lightning.pytorch.callbacks.callback import Callback
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/lightning/pytorch/callbacks/callback.py", line 22, in <module>
    from lightning.pytorch.utilities.types import STEP_OUTPUT
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/lightning/pytorch/utilities/types.py", line 42, in <module>

(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm »     from torchmetrics import Metric                                                                                         130 ↵ richard@sn4622117596
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/torchmetrics/__init__.py", line 26, in <module>
    from torchmetrics import functional  # noqa: E402
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/torchmetrics/functional/__init__.py", line 122, in <module>
    from torchmetrics.functional.text._deprecated import _bleu_score as bleu_score
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/torchmetrics/functional/text/__init__.py", line 49, in <module>
    if _TRANSFORMERS_GREATER_EQUAL_4_4:
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/lightning_utilities/core/imports.py", line 164, in __bool__
    self._check_available()
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/lightning_utilities/core/imports.py", line 158, in _check_available
    self._check_requirement()
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/lightning_utilities/core/imports.py", line 132, in _check_requirement
    pkg_resources.require(self.requirement)
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/__init__.py", line 937, in require
    needed = self.resolve(parse_requirements(requirements))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/__init__.py", line 803, in resolve
    new_requirements = dist.requires(req.extras)[::-1]
                       ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/__init__.py", line 2786, in requires
    dm = self._dep_map
         ^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/__init__.py", line 3072, in _dep_map
    self.__dep_map = self._compute_dependencies()
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/__init__.py", line 3082, in _compute_dependencies
    reqs.extend(parse_requirements(req))
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/__init__.py", line 3135, in __init__
    super().__init__(requirement_string)
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/_vendor/packaging/requirements.py", line 35, in __init__
    parsed = _parse_requirement(requirement_string)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/_vendor/packaging/_parser.py", line 64, in parse_requirement
    return _parse_requirement(Tokenizer(source, rules=DEFAULT_RULES))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/_vendor/packaging/_parser.py", line 82, in _parse_requirement
    url, specifier, marker = _parse_requirement_details(tokenizer)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/_vendor/packaging/_parser.py", line 126, in _parse_requirement_details
    marker = _parse_requirement_marker(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/_vendor/packaging/_parser.py", line 153, in _parse_requirement_marker
    marker = _parse_marker(tokenizer)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/_vendor/packaging/_parser.py", line 268, in _parse_marker
    expression = [_parse_marker_atom(tokenizer)]
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/_vendor/packaging/_parser.py", line 293, in _parse_marker_atom
    marker = _parse_marker_item(tokenizer)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/_vendor/packaging/_parser.py", line 308, in _parse_marker_item
    tokenizer.consume("WS")
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/_vendor/packaging/_tokenizer.py", line 110, in consume
    if self.check(name):
       ^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/pkg_resources/_vendor/packaging/_tokenizer.py", line 113, in check
    def check(self, name: str, *, peek: bool = False) -> bool:

KeyboardInterrupt

(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python evaluate.py --model_path                                                                                             130 ↵ richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python evaluate_all.py                                                                                                      130 ↵ richard@sn4622117596
['step-000700', 'step-000750', 'step-000800', 'step-000850', 'step-000900', 'step-000950', 'step-0001000', 'step-0001050', 'step-0001100', 'step-0001150', 'step-0001
200', 'step-0001250', 'step-0001300', 'step-0001350', 'step-0001400', 'step-0001450', 'step-0001500', 'step-0001550', 'step-0001600', 'step-0001650', 'step-0001700',
 'step-0001750', 'step-0001800', 'step-0001850', 'step-0001900', 'step-0001950', 'step-0002000', 'step-0002050', 'step-0002100', 'step-0002150', 'step-0002200', 'ste
p-0002250', 'step-0002300', 'step-0002350', 'step-0002400', 'step-0002450', 'step-0002500', 'step-0002550', 'step-0002600', 'step-0002650', 'step-0002700']
Evaluating step-000700
INFO:     Started server process [225259]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
step-000700
  0%|                                                                                                                                        | 0/100 [00:00<?, ?it/s]
INFO:     127.0.0.1:55374 - "POST /predict HTTP/1.1" 200 OK
  1%|█▎                                                                                                                              | 1/100 [00:14<23:19, 14.14s/it]
INFO:     127.0.0.1:60748 - "POST /predict HTTP/1.1" 200 OK
  2%|██▌                                                                                                                             | 2/100 [00:14<09:38,  5.90s/it]
INFO:     127.0.0.1:60756 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:60770 - "POST /predict HTTP/1.1" 200 OK
  4%|█████                                                                                                                           | 4/100 [00:14<03:37,  2.26s/it]
INFO:     127.0.0.1:60780 - "POST /predict HTTP/1.1" 200 OK
  5%|██████▍                                                                                                                         | 5/100 [00:14<02:31,  1.59s/it]
INFO:     127.0.0.1:60796 - "POST /predict HTTP/1.1" 200 OK
  6%|███████▋                                                                                                                        | 6/100 [00:14<01:48,  1.16s/it]
INFO:     127.0.0.1:60800 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:60802 - "POST /predict HTTP/1.1" 200 OK
  8%|██████████▏                                                                                                                     | 8/100 [00:14<01:00,  1.52it/s]
INFO:     127.0.0.1:60814 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:60824 - "POST /predict HTTP/1.1" 200 OK
 10%|████████████▋                                                                                                                  | 10/100 [00:15<00:39,  2.30it/s]
INFO:     127.0.0.1:60830 - "POST /predict HTTP/1.1" 200 OK
 11%|█████████████▉                                                                                                                 | 11/100 [00:15<00:32,  2.77it/s]
INFO:     127.0.0.1:60840 - "POST /predict HTTP/1.1" 200 OK
 12%|███████████████▏                                                                                                               | 12/100 [00:15<00:26,  3.36it/s]
INFO:     127.0.0.1:60842 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:60846 - "POST /predict HTTP/1.1" 200 OK
 14%|█████████████████▊                                                                                                             | 14/100 [00:15<00:19,  4.33it/s]
INFO:     127.0.0.1:60850 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:60854 - "POST /predict HTTP/1.1" 200 OK
 16%|████████████████████▎                                                                                                          | 16/100 [00:15<00:15,  5.47it/s]
INFO:     127.0.0.1:60862 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:60868 - "POST /predict HTTP/1.1" 200 OK
 18%|██████████████████████▊                                                                                                        | 18/100 [00:15<00:12,  6.49it/s]
INFO:     127.0.0.1:60878 - "POST /predict HTTP/1.1" 200 OK
 19%|████████████████████████▏                                                                                                      | 19/100 [00:16<00:11,  6.97it/s]
INFO:     127.0.0.1:60886 - "POST /predict HTTP/1.1" 200 OK
 20%|█████████████████████████▍                                                                                                     | 20/100 [00:16<00:12,  6.62it/s]
INFO:     127.0.0.1:60890 - "POST /predict HTTP/1.1" 200 OK
 21%|██████████████████████████▋                                                                                                    | 21/100 [00:16<00:10,  7.18it/s]
INFO:     127.0.0.1:60898 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:60900 - "POST /predict HTTP/1.1" 200 OK
 23%|█████████████████████████████▏                                                                                                 | 23/100 [00:16<00:10,  7.58it/s]
INFO:     127.0.0.1:60906 - "POST /predict HTTP/1.1" 200 OK
 24%|██████████████████████████████▍                                                                                                | 24/100 [00:16<00:09,  8.01it/s]
INFO:     127.0.0.1:60910 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:60920 - "POST /predict HTTP/1.1" 200 OK
 26%|█████████████████████████████████                                                                                              | 26/100 [00:16<00:08,  8.97it/s]
INFO:     127.0.0.1:60926 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:60932 - "POST /predict HTTP/1.1" 200 OK
 28%|███████████████████████████████████▌                                                                                           | 28/100 [00:17<00:07,  9.45it/s]
INFO:     127.0.0.1:60946 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:60950 - "POST /predict HTTP/1.1" 200 OK
 30%|██████████████████████████████████████                                                                                         | 30/100 [00:17<00:07,  9.77it/s]
INFO:     127.0.0.1:60960 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:60970 - "POST /predict HTTP/1.1" 200 OK
 32%|████████████████████████████████████████▋                                                                                      | 32/100 [00:17<00:06, 10.15it/s]
INFO:     127.0.0.1:60980 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:60992 - "POST /predict HTTP/1.1" 200 OK
 34%|███████████████████████████████████████████▏                                                                                   | 34/100 [00:17<00:06, 10.09it/s]
INFO:     127.0.0.1:32776 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:32784 - "POST /predict HTTP/1.1" 200 OK
 36%|█████████████████████████████████████████████▋                                                                                 | 36/100 [00:17<00:06, 10.21it/s]
INFO:     127.0.0.1:32800 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:32806 - "POST /predict HTTP/1.1" 200 OK
 38%|████████████████████████████████████████████████▎                                                                              | 38/100 [00:18<00:06, 10.11it/s]
INFO:     127.0.0.1:32812 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:32826 - "POST /predict HTTP/1.1" 200 OK
 40%|██████████████████████████████████████████████████▊                                                                            | 40/100 [00:18<00:05, 10.08it/s]
INFO:     127.0.0.1:32842 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:32850 - "POST /predict HTTP/1.1" 200 OK
 42%|█████████████████████████████████████████████████████▎                                                                         | 42/100 [00:18<00:05, 10.04it/s]
INFO:     127.0.0.1:32864 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:32878 - "POST /predict HTTP/1.1" 200 OK
 44%|███████████████████████████████████████████████████████▉                                                                       | 44/100 [00:18<00:05, 10.00it/s]
INFO:     127.0.0.1:32882 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:32884 - "POST /predict HTTP/1.1" 200 OK
 46%|██████████████████████████████████████████████████████████▍                                                                    | 46/100 [00:18<00:05,  9.99it/s]
INFO:     127.0.0.1:32890 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:32900 - "POST /predict HTTP/1.1" 200 OK
 48%|████████████████████████████████████████████████████████████▉                                                                  | 48/100 [00:19<00:05,  8.97it/s]
INFO:     127.0.0.1:32912 - "POST /predict HTTP/1.1" 200 OK
 49%|██████████████████████████████████████████████████████████████▏                                                                | 49/100 [00:19<00:05,  9.13it/s]
INFO:     127.0.0.1:32918 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:32934 - "POST /predict HTTP/1.1" 200 OK
 51%|████████████████████████████████████████████████████████████████▊                                                              | 51/100 [00:19<00:05,  9.68it/s]
INFO:     127.0.0.1:32938 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:32946 - "POST /predict HTTP/1.1" 200 OK
 53%|███████████████████████████████████████████████████████████████████▎                                                           | 53/100 [00:19<00:04,  9.92it/s]
INFO:     127.0.0.1:32962 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:32978 - "POST /predict HTTP/1.1" 200 OK
 55%|█████████████████████████████████████████████████████████████████████▊                                                         | 55/100 [00:19<00:05,  8.99it/s]
INFO:     127.0.0.1:32980 - "POST /predict HTTP/1.1" 200 OK
 56%|███████████████████████████████████████████████████████████████████████                                                        | 56/100 [00:19<00:04,  9.15it/s]
INFO:     127.0.0.1:32986 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:32992 - "POST /predict HTTP/1.1" 200 OK
 58%|█████████████████████████████████████████████████████████████████████████▋                                                     | 58/100 [00:20<00:04,  9.45it/s]
INFO:     127.0.0.1:33006 - "POST /predict HTTP/1.1" 200 OK
 59%|██████████████████████████████████████████████████████████████████████████▉                                                    | 59/100 [00:20<00:04,  9.53it/s]
INFO:     127.0.0.1:33012 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:33026 - "POST /predict HTTP/1.1" 200 OK
 61%|█████████████████████████████████████████████████████████████████████████████▍                                                 | 61/100 [00:20<00:03,  9.87it/s]
INFO:     127.0.0.1:33028 - "POST /predict HTTP/1.1" 200 OK
 62%|██████████████████████████████████████████████████████████████████████████████▋                                                | 62/100 [00:20<00:03,  9.87it/s]
INFO:     127.0.0.1:33040 - "POST /predict HTTP/1.1" 200 OK
 63%|████████████████████████████████████████████████████████████████████████████████                                               | 63/100 [00:20<00:03,  9.90it/s]
INFO:     127.0.0.1:33048 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:33056 - "POST /predict HTTP/1.1" 200 OK
 65%|██████████████████████████████████████████████████████████████████████████████████▌                                            | 65/100 [00:20<00:03, 10.13it/s]
INFO:     127.0.0.1:33070 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:33076 - "POST /predict HTTP/1.1" 200 OK
 67%|█████████████████████████████████████████████████████████████████████████████████████                                          | 67/100 [00:21<00:03, 10.26it/s]
INFO:     127.0.0.1:33082 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:33084 - "POST /predict HTTP/1.1" 200 OK
 69%|███████████████████████████████████████████████████████████████████████████████████████▋                                       | 69/100 [00:21<00:03, 10.32it/s]
INFO:     127.0.0.1:33090 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:33098 - "POST /predict HTTP/1.1" 200 OK
 71%|██████████████████████████████████████████████████████████████████████████████████████████▏                                    | 71/100 [00:21<00:02, 10.21it/s]
INFO:     127.0.0.1:33106 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:33118 - "POST /predict HTTP/1.1" 200 OK
 73%|████████████████████████████████████████████████████████████████████████████████████████████▋                                  | 73/100 [00:21<00:02, 10.30it/s]
INFO:     127.0.0.1:33120 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:33124 - "POST /predict HTTP/1.1" 200 OK
 75%|███████████████████████████████████████████████████████████████████████████████████████████████▎                               | 75/100 [00:21<00:02, 10.22it/s]
INFO:     127.0.0.1:33128 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:33138 - "POST /predict HTTP/1.1" 200 OK
 77%|█████████████████████████████████████████████████████████████████████████████████████████████████▊                             | 77/100 [00:22<00:02, 10.17it/s]
INFO:     127.0.0.1:33146 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:33152 - "POST /predict HTTP/1.1" 200 OK
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████▎                          | 79/100 [00:22<00:02, 10.47it/s]
INFO:     127.0.0.1:33162 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:33164 - "POST /predict HTTP/1.1" 200 OK
 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                        | 81/100 [00:22<00:01, 10.37it/s]
INFO:     127.0.0.1:33180 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:33186 - "POST /predict HTTP/1.1" 200 OK
 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▍                     | 83/100 [00:22<00:01,  9.31it/s]
INFO:     127.0.0.1:33194 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:33204 - "POST /predict HTTP/1.1" 200 OK
 85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                   | 85/100 [00:22<00:01,  9.54it/s]
INFO:     127.0.0.1:33220 - "POST /predict HTTP/1.1" 200 OK
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 86/100 [00:23<00:01,  8.50it/s]
INFO:     127.0.0.1:52034 - "POST /predict HTTP/1.1" 200 OK
 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 87/100 [00:23<00:01,  7.73it/s]
INFO:     127.0.0.1:52040 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:52056 - "POST /predict HTTP/1.1" 200 OK
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 89/100 [00:23<00:01,  8.60it/s]
INFO:     127.0.0.1:52064 - "POST /predict HTTP/1.1" 200 OK
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 90/100 [00:23<00:01,  7.76it/s]
INFO:     127.0.0.1:52080 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:52094 - "POST /predict HTTP/1.1" 200 OK
 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊          | 92/100 [00:23<00:01,  7.66it/s]
INFO:     127.0.0.1:52108 - "POST /predict HTTP/1.1" 200 OK
 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████         | 93/100 [00:23<00:00,  8.04it/s]
INFO:     127.0.0.1:52112 - "POST /predict HTTP/1.1" 200 OK
 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 94/100 [00:24<00:00,  8.42it/s]
INFO:     127.0.0.1:52116 - "POST /predict HTTP/1.1" 200 OK
 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 95/100 [00:24<00:00,  7.50it/s]
INFO:     127.0.0.1:52118 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:52132 - "POST /predict HTTP/1.1" 200 OK
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏   | 97/100 [00:24<00:00,  8.42it/s]
INFO:     127.0.0.1:52138 - "POST /predict HTTP/1.1" 200 OK
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍  | 98/100 [00:24<00:00,  7.57it/s]
INFO:     127.0.0.1:52152 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:52162 - "POST /predict HTTP/1.1" 200 OK
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:24<00:00,  4.03it/s]
Accuracy of step-000700 on Eval Dataset: 0.605
Processes on GPU 7: [225296]
Terminated process with PID: 225296 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 225259 richard  243u  IPv4 1235564      0t0  TCP *:8000 (LISTEN)

Port Process 225259 Killed

Evaluating step-000750
INFO:     Started server process [225512]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
  0%|                                                                                                                                        | 0/100 [00:00<?, ?it/s]
INFO:     127.0.0.1:59738 - "POST /predict HTTP/1.1" 504 Gateway Timeout
  0%|                                                                                                                                        | 0/100 [00:30<?, ?it/s]
Traceback (most recent call last):
  File "/data/richard/poker_llm/evaluate.py", line 58, in <module>
    model_response = response.json()['output'].split("Your optimal action is:")[1]
                     ~~~~~~~~~~~~~~~^^^^^^^^^^
KeyError: 'output'
Processes on GPU 7: [225540]
Terminated process with PID: 225540 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 225512 richard  243u  IPv4 1600623      0t0  TCP *:8000 (LISTEN)

Port Process 225512 Killed

Evaluating step-000800
INFO:     Started server process [225731]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
  0%|                                                                                                                                        | 0/100 [00:00<?, ?it/s]
INFO:     127.0.0.1:47250 - "POST /predict HTTP/1.1" 504 Gateway Timeout
  0%|                                                                                                                                        | 0/100 [00:30<?, ?it/s]
Traceback (most recent call last):
  File "/data/richard/poker_llm/evaluate.py", line 58, in <module>
    model_response = response.json()['output'].split("Your optimal action is:")[1]
                     ~~~~~~~~~~~~~~~^^^^^^^^^^
KeyError: 'output'
Processes on GPU 7: [225748]
Terminated process with PID: 225748 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 225731 richard  243u  IPv4 1600289      0t0  TCP *:8000 (LISTEN)

Port Process 225731 Killed

^CTraceback (most recent call last):
  File "/data/richard/poker_llm/evaluate_all.py", line 77, in <module>
    time.sleep(5)
KeyboardInterrupt

(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » nvidia-smi                                                                                                                  130 ↵ richard@sn4622117596
Sat May 25 16:38:14 2024
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.06              Driver Version: 545.23.06    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100 80GB PCIe          On  | 00000000:4F:00.0 Off |                    0 |
| N/A   65C    P0             301W / 300W |  78193MiB / 81920MiB |    100%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100 80GB PCIe          On  | 00000000:52:00.0 Off |                    0 |
| N/A   66C    P0             299W / 300W |  80009MiB / 81920MiB |    100%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100 80GB PCIe          On  | 00000000:56:00.0 Off |                    0 |
| N/A   29C    P0              54W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100 80GB PCIe          On  | 00000000:57:00.0 Off |                    0 |
| N/A   30C    P0              51W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA A100 80GB PCIe          On  | 00000000:D1:00.0 Off |                    0 |
| N/A   30C    P0              52W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA A100 80GB PCIe          On  | 00000000:D2:00.0 Off |                    0 |
| N/A   31C    P0              52W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA A100 80GB PCIe          On  | 00000000:D5:00.0 Off |                    0 |
| N/A   31C    P0              53W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA A100 80GB PCIe          On  | 00000000:D6:00.0 Off |                    0 |
| N/A   30C    P0              54W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+

+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|    0   N/A  N/A     45833      C   ...d/miniconda3/envs/litgpt/bin/python    78180MiB |
|    1   N/A  N/A     45858      C   ...d/miniconda3/envs/litgpt/bin/python    79996MiB |
+---------------------------------------------------------------------------------------+
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » lsof -i :8000                                                                                                                     richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python evaluate_all.py                                                                                                        1 ↵ richard@sn4622117596
['step-000700', 'step-000750', 'step-000800', 'step-000850', 'step-000900', 'step-000950', 'step-0001000', 'step-0001050', 'step-0001100', 'step-0001150', 'step-0001
200', 'step-0001250', 'step-0001300', 'step-0001350', 'step-0001400', 'step-0001450', 'step-0001500', 'step-0001550', 'step-0001600', 'step-0001650', 'step-0001700',
 'step-0001750', 'step-0001800', 'step-0001850', 'step-0001900', 'step-0001950', 'step-0002000', 'step-0002050', 'step-0002100', 'step-0002150', 'step-0002200', 'ste
p-0002250', 'step-0002300', 'step-0002350', 'step-0002400', 'step-0002450', 'step-0002500', 'step-0002550', 'step-0002600', 'step-0002650', 'step-0002700']
Evaluating step-000700
INFO:     Started server process [226660]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
  0%|                                                                                                                                        | 0/100 [00:00<?, ?it/s]
INFO:     127.0.0.1:51700 - "POST /predict HTTP/1.1" 200 OK
  1%|█▎                                                                                                                              | 1/100 [00:11<19:23, 11.75s/it]
INFO:     127.0.0.1:47286 - "POST /predict HTTP/1.1" 200 OK
  2%|██▌                                                                                                                             | 2/100 [00:11<08:01,  4.91s/it]
INFO:     127.0.0.1:47296 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47306 - "POST /predict HTTP/1.1" 200 OK
  4%|█████                                                                                                                           | 4/100 [00:12<03:01,  1.89s/it]
INFO:     127.0.0.1:47316 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47322 - "POST /predict HTTP/1.1" 200 OK
  6%|███████▋                                                                                                                        | 6/100 [00:12<01:39,  1.05s/it]
INFO:     127.0.0.1:47326 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47332 - "POST /predict HTTP/1.1" 200 OK
  8%|██████████▏                                                                                                                     | 8/100 [00:12<01:01,  1.51it/s]
INFO:     127.0.0.1:47342 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47358 - "POST /predict HTTP/1.1" 200 OK
 10%|████████████▋                                                                                                                  | 10/100 [00:12<00:41,  2.19it/s]
INFO:     127.0.0.1:47362 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47364 - "POST /predict HTTP/1.1" 200 OK
 12%|███████████████▏                                                                                                               | 12/100 [00:12<00:29,  3.01it/s]
INFO:     127.0.0.1:47372 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47380 - "POST /predict HTTP/1.1" 200 OK
 14%|█████████████████▊                                                                                                             | 14/100 [00:13<00:22,  3.81it/s]
INFO:     127.0.0.1:47394 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47408 - "POST /predict HTTP/1.1" 200 OK
 16%|████████████████████▎                                                                                                          | 16/100 [00:13<00:17,  4.79it/s]
INFO:     127.0.0.1:47418 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47428 - "POST /predict HTTP/1.1" 200 OK
 18%|██████████████████████▊                                                                                                        | 18/100 [00:13<00:14,  5.79it/s]
INFO:     127.0.0.1:47436 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47448 - "POST /predict HTTP/1.1" 200 OK
 20%|█████████████████████████▍                                                                                                     | 20/100 [00:13<00:12,  6.30it/s]
INFO:     127.0.0.1:47458 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47466 - "POST /predict HTTP/1.1" 200 OK
 22%|███████████████████████████▉                                                                                                   | 22/100 [00:13<00:10,  7.21it/s]
INFO:     127.0.0.1:47468 - "POST /predict HTTP/1.1" 200 OK
 23%|█████████████████████████████▏                                                                                                 | 23/100 [00:14<00:10,  7.30it/s]
INFO:     127.0.0.1:47478 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47488 - "POST /predict HTTP/1.1" 200 OK
 25%|███████████████████████████████▊                                                                                               | 25/100 [00:14<00:09,  8.25it/s]
INFO:     127.0.0.1:47492 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47496 - "POST /predict HTTP/1.1" 200 OK
 27%|██████████████████████████████████▎                                                                                            | 27/100 [00:14<00:08,  9.12it/s]
INFO:     127.0.0.1:47504 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47520 - "POST /predict HTTP/1.1" 200 OK
 29%|████████████████████████████████████▊                                                                                          | 29/100 [00:14<00:07,  9.55it/s]
INFO:     127.0.0.1:47524 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47532 - "POST /predict HTTP/1.1" 200 OK
 31%|███████████████████████████████████████▎                                                                                       | 31/100 [00:14<00:06, 10.13it/s]
INFO:     127.0.0.1:47544 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47550 - "POST /predict HTTP/1.1" 200 OK
 33%|█████████████████████████████████████████▉                                                                                     | 33/100 [00:14<00:06, 10.43it/s]
INFO:     127.0.0.1:47564 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47576 - "POST /predict HTTP/1.1" 200 OK
 35%|████████████████████████████████████████████▍                                                                                  | 35/100 [00:15<00:06, 10.49it/s]
INFO:     127.0.0.1:47580 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47584 - "POST /predict HTTP/1.1" 200 OK
 37%|██████████████████████████████████████████████▉                                                                                | 37/100 [00:15<00:05, 10.71it/s]
INFO:     127.0.0.1:47586 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47594 - "POST /predict HTTP/1.1" 200 OK
 39%|█████████████████████████████████████████████████▌                                                                             | 39/100 [00:15<00:05, 10.69it/s]
INFO:     127.0.0.1:47602 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47612 - "POST /predict HTTP/1.1" 200 OK
 41%|████████████████████████████████████████████████████                                                                           | 41/100 [00:15<00:05, 10.62it/s]
INFO:     127.0.0.1:47614 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47630 - "POST /predict HTTP/1.1" 200 OK
 43%|██████████████████████████████████████████████████████▌                                                                        | 43/100 [00:15<00:05, 10.58it/s]
INFO:     127.0.0.1:47636 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47648 - "POST /predict HTTP/1.1" 200 OK
 45%|█████████████████████████████████████████████████████████▏                                                                     | 45/100 [00:16<00:05, 10.60it/s]
INFO:     127.0.0.1:47652 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47668 - "POST /predict HTTP/1.1" 200 OK
 47%|███████████████████████████████████████████████████████████▋                                                                   | 47/100 [00:16<00:05,  9.63it/s]
INFO:     127.0.0.1:47678 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47686 - "POST /predict HTTP/1.1" 200 OK
 49%|██████████████████████████████████████████████████████████████▏                                                                | 49/100 [00:16<00:05,  9.93it/s]
INFO:     127.0.0.1:47696 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47712 - "POST /predict HTTP/1.1" 200 OK
 51%|████████████████████████████████████████████████████████████████▊                                                              | 51/100 [00:16<00:04, 10.45it/s]
INFO:     127.0.0.1:47716 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47718 - "POST /predict HTTP/1.1" 200 OK
 53%|███████████████████████████████████████████████████████████████████▎                                                           | 53/100 [00:16<00:04, 10.65it/s]
INFO:     127.0.0.1:47734 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47748 - "POST /predict HTTP/1.1" 200 OK
 55%|█████████████████████████████████████████████████████████████████████▊                                                         | 55/100 [00:17<00:04, 10.80it/s]
INFO:     127.0.0.1:47758 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47772 - "POST /predict HTTP/1.1" 200 OK
 57%|████████████████████████████████████████████████████████████████████████▍                                                      | 57/100 [00:17<00:03, 10.76it/s]
INFO:     127.0.0.1:47784 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47796 - "POST /predict HTTP/1.1" 200 OK
 59%|██████████████████████████████████████████████████████████████████████████▉                                                    | 59/100 [00:17<00:03, 10.69it/s]
INFO:     127.0.0.1:47812 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47818 - "POST /predict HTTP/1.1" 200 OK
 61%|█████████████████████████████████████████████████████████████████████████████▍                                                 | 61/100 [00:17<00:03, 10.83it/s]
INFO:     127.0.0.1:47830 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47836 - "POST /predict HTTP/1.1" 200 OK
 63%|████████████████████████████████████████████████████████████████████████████████                                               | 63/100 [00:17<00:03, 10.78it/s]
INFO:     127.0.0.1:47850 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47858 - "POST /predict HTTP/1.1" 200 OK
 65%|██████████████████████████████████████████████████████████████████████████████████▌                                            | 65/100 [00:17<00:03, 10.88it/s]
INFO:     127.0.0.1:47860 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47872 - "POST /predict HTTP/1.1" 200 OK
 67%|█████████████████████████████████████████████████████████████████████████████████████                                          | 67/100 [00:18<00:03, 10.97it/s]
INFO:     127.0.0.1:47882 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47888 - "POST /predict HTTP/1.1" 200 OK
 69%|███████████████████████████████████████████████████████████████████████████████████████▋                                       | 69/100 [00:18<00:02, 11.04it/s]
INFO:     127.0.0.1:47902 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47908 - "POST /predict HTTP/1.1" 200 OK
 71%|██████████████████████████████████████████████████████████████████████████████████████████▏                                    | 71/100 [00:18<00:02, 10.92it/s]
INFO:     127.0.0.1:47914 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47922 - "POST /predict HTTP/1.1" 200 OK
 73%|████████████████████████████████████████████████████████████████████████████████████████████▋                                  | 73/100 [00:18<00:02, 11.00it/s]
INFO:     127.0.0.1:47934 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47950 - "POST /predict HTTP/1.1" 200 OK
 75%|███████████████████████████████████████████████████████████████████████████████████████████████▎                               | 75/100 [00:18<00:02, 10.93it/s]
INFO:     127.0.0.1:47960 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47972 - "POST /predict HTTP/1.1" 200 OK
 77%|█████████████████████████████████████████████████████████████████████████████████████████████████▊                             | 77/100 [00:19<00:02, 10.84it/s]
INFO:     127.0.0.1:47980 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:47990 - "POST /predict HTTP/1.1" 200 OK
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████▎                          | 79/100 [00:19<00:01, 11.12it/s]
INFO:     127.0.0.1:47996 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:48002 - "POST /predict HTTP/1.1" 200 OK
 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                        | 81/100 [00:19<00:01, 11.00it/s]
INFO:     127.0.0.1:56980 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:56988 - "POST /predict HTTP/1.1" 200 OK
 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▍                     | 83/100 [00:19<00:01,  9.98it/s]
INFO:     127.0.0.1:57002 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:57010 - "POST /predict HTTP/1.1" 200 OK
 85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                   | 85/100 [00:19<00:01, 10.16it/s]
INFO:     127.0.0.1:57014 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:57020 - "POST /predict HTTP/1.1" 200 OK
 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 87/100 [00:20<00:01,  8.59it/s]
INFO:     127.0.0.1:57028 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:57030 - "POST /predict HTTP/1.1" 200 OK
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 89/100 [00:20<00:01,  9.22it/s]
INFO:     127.0.0.1:57044 - "POST /predict HTTP/1.1" 200 OK
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 90/100 [00:20<00:01,  8.52it/s]
INFO:     127.0.0.1:57054 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:57062 - "POST /predict HTTP/1.1" 200 OK
 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊          | 92/100 [00:20<00:00,  8.43it/s]
INFO:     127.0.0.1:57074 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:57086 - "POST /predict HTTP/1.1" 200 OK
 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 94/100 [00:20<00:00,  9.02it/s]
INFO:     127.0.0.1:57090 - "POST /predict HTTP/1.1" 200 OK
 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 95/100 [00:21<00:00,  8.35it/s]
INFO:     127.0.0.1:57096 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:57100 - "POST /predict HTTP/1.1" 200 OK
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏   | 97/100 [00:21<00:00,  9.02it/s]
INFO:     127.0.0.1:57104 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:57114 - "POST /predict HTTP/1.1" 200 OK
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 99/100 [00:21<00:00,  9.49it/s]
INFO:     127.0.0.1:57128 - "POST /predict HTTP/1.1" 200 OK
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:21<00:00,  4.63it/s]
Accuracy of step-000700 on Eval Dataset: 0.585
Processes on GPU 7: [226687]
Terminated process with PID: 226687 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 226660 richard  243u  IPv4 1600509      0t0  TCP *:8000 (LISTEN)

Port Process 226660 Killed
Killed

Evaluating step-000750
INFO:     Started server process [226905]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
  0%|                                                                                                                                        | 0/100 [00:00<?, ?it/s]
INFO:     127.0.0.1:48172 - "POST /predict HTTP/1.1" 200 OK
  1%|█▎                                                                                                                              | 1/100 [00:10<17:21, 10.52s/it]
INFO:     127.0.0.1:52174 - "POST /predict HTTP/1.1" 200 OK
  2%|██▌                                                                                                                             | 2/100 [00:10<07:10,  4.39s/it]
INFO:     127.0.0.1:52188 - "POST /predict HTTP/1.1" 200 OK
  3%|███▊                                                                                                                            | 3/100 [00:10<03:58,  2.45s/it]
INFO:     127.0.0.1:52200 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:52216 - "POST /predict HTTP/1.1" 200 OK
  5%|██████▍                                                                                                                         | 5/100 [00:10<01:46,  1.12s/it]
INFO:     127.0.0.1:52226 - "POST /predict HTTP/1.1" 200 OK
  6%|███████▋                                                                                                                        | 6/100 [00:11<01:18,  1.19it/s]
INFO:     127.0.0.1:52238 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:52246 - "POST /predict HTTP/1.1" 200 OK
  8%|██████████▏                                                                                                                     | 8/100 [00:11<00:45,  2.00it/s]
INFO:     127.0.0.1:52254 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:42784 - "POST /predict HTTP/1.1" 200 OK
 10%|████████████▋                                                                                                                  | 10/100 [00:11<00:30,  2.94it/s]
INFO:     127.0.0.1:42798 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:42810 - "POST /predict HTTP/1.1" 200 OK
 12%|███████████████▏                                                                                                               | 12/100 [00:11<00:22,  3.96it/s]
INFO:     127.0.0.1:42812 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:42826 - "POST /predict HTTP/1.1" 200 OK
 14%|█████████████████▊                                                                                                             | 14/100 [00:11<00:17,  4.80it/s]
INFO:     127.0.0.1:42838 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:42854 - "POST /predict HTTP/1.1" 200 OK
 16%|████████████████████▎                                                                                                          | 16/100 [00:12<00:14,  5.88it/s]
INFO:     127.0.0.1:42866 - "POST /predict HTTP/1.1" 200 OK
 17%|█████████████████████▌                                                                                                         | 17/100 [00:12<00:13,  5.98it/s]
INFO:     127.0.0.1:42878 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:42894 - "POST /predict HTTP/1.1" 200 OK
 19%|████████████████████████▏                                                                                                      | 19/100 [00:12<00:11,  7.11it/s]
INFO:     127.0.0.1:42908 - "POST /predict HTTP/1.1" 200 OK
 20%|█████████████████████████▍                                                                                                     | 20/100 [00:12<00:11,  6.95it/s]
INFO:     127.0.0.1:42924 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:42930 - "POST /predict HTTP/1.1" 200 OK
 22%|███████████████████████████▉                                                                                                   | 22/100 [00:12<00:09,  7.96it/s]
INFO:     127.0.0.1:42944 - "POST /predict HTTP/1.1" 200 OK
 23%|█████████████████████████████▏                                                                                                 | 23/100 [00:12<00:09,  7.93it/s]
INFO:     127.0.0.1:42946 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:42948 - "POST /predict HTTP/1.1" 200 OK
 25%|███████████████████████████████▊                                                                                               | 25/100 [00:13<00:08,  8.88it/s]
INFO:     127.0.0.1:42956 - "POST /predict HTTP/1.1" 200 OK
 26%|█████████████████████████████████                                                                                              | 26/100 [00:13<00:08,  8.65it/s]
INFO:     127.0.0.1:42968 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:42974 - "POST /predict HTTP/1.1" 200 OK
 28%|███████████████████████████████████▌                                                                                           | 28/100 [00:13<00:07,  9.44it/s]
INFO:     127.0.0.1:42980 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:42992 - "POST /predict HTTP/1.1" 200 OK
 30%|██████████████████████████████████████                                                                                         | 30/100 [00:13<00:06, 10.01it/s]
INFO:     127.0.0.1:42994 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43008 - "POST /predict HTTP/1.1" 200 OK
 32%|████████████████████████████████████████▋                                                                                      | 32/100 [00:13<00:06, 10.48it/s]
INFO:     127.0.0.1:43020 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43030 - "POST /predict HTTP/1.1" 200 OK
 34%|███████████████████████████████████████████▏                                                                                   | 34/100 [00:13<00:06, 10.53it/s]
INFO:     127.0.0.1:43032 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43044 - "POST /predict HTTP/1.1" 200 OK
 36%|█████████████████████████████████████████████▋                                                                                 | 36/100 [00:14<00:05, 10.71it/s]
INFO:     127.0.0.1:43048 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43058 - "POST /predict HTTP/1.1" 200 OK
 38%|████████████████████████████████████████████████▎                                                                              | 38/100 [00:14<00:05, 10.69it/s]
INFO:     127.0.0.1:43064 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43066 - "POST /predict HTTP/1.1" 200 OK
 40%|██████████████████████████████████████████████████▊                                                                            | 40/100 [00:14<00:05, 10.67it/s]
INFO:     127.0.0.1:43068 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43082 - "POST /predict HTTP/1.1" 200 OK
 42%|█████████████████████████████████████████████████████▎                                                                         | 42/100 [00:14<00:05, 10.66it/s]
INFO:     127.0.0.1:43084 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43100 - "POST /predict HTTP/1.1" 200 OK
 44%|███████████████████████████████████████████████████████▉                                                                       | 44/100 [00:14<00:05, 10.74it/s]
INFO:     127.0.0.1:43108 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43114 - "POST /predict HTTP/1.1" 200 OK
 46%|██████████████████████████████████████████████████████████▍                                                                    | 46/100 [00:15<00:04, 10.81it/s]
INFO:     127.0.0.1:43126 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43142 - "POST /predict HTTP/1.1" 200 OK
 48%|████████████████████████████████████████████████████████████▉                                                                  | 48/100 [00:15<00:04, 10.83it/s]
INFO:     127.0.0.1:43152 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43154 - "POST /predict HTTP/1.1" 200 OK
 50%|███████████████████████████████████████████████████████████████▌                                                               | 50/100 [00:15<00:05,  9.90it/s]
INFO:     127.0.0.1:43168 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43180 - "POST /predict HTTP/1.1" 200 OK
 52%|██████████████████████████████████████████████████████████████████                                                             | 52/100 [00:15<00:05,  9.42it/s]
INFO:     127.0.0.1:43196 - "POST /predict HTTP/1.1" 200 OK
 53%|███████████████████████████████████████████████████████████████████▎                                                           | 53/100 [00:15<00:05,  8.70it/s]
INFO:     127.0.0.1:43208 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43218 - "POST /predict HTTP/1.1" 200 OK
 55%|█████████████████████████████████████████████████████████████████████▊                                                         | 55/100 [00:16<00:04,  9.45it/s]
INFO:     127.0.0.1:43228 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43230 - "POST /predict HTTP/1.1" 200 OK
 57%|████████████████████████████████████████████████████████████████████████▍                                                      | 57/100 [00:16<00:04,  9.85it/s]
INFO:     127.0.0.1:43246 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43252 - "POST /predict HTTP/1.1" 200 OK
 59%|██████████████████████████████████████████████████████████████████████████▉                                                    | 59/100 [00:16<00:04, 10.06it/s]
INFO:     127.0.0.1:43262 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43268 - "POST /predict HTTP/1.1" 200 OK
 61%|█████████████████████████████████████████████████████████████████████████████▍                                                 | 61/100 [00:16<00:04,  9.40it/s]
INFO:     127.0.0.1:43278 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43292 - "POST /predict HTTP/1.1" 200 OK
 63%|████████████████████████████████████████████████████████████████████████████████                                               | 63/100 [00:16<00:03,  9.77it/s]
INFO:     127.0.0.1:43296 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43310 - "POST /predict HTTP/1.1" 200 OK
 65%|██████████████████████████████████████████████████████████████████████████████████▌                                            | 65/100 [00:17<00:03, 10.15it/s]
INFO:     127.0.0.1:43320 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43328 - "POST /predict HTTP/1.1" 200 OK
 67%|█████████████████████████████████████████████████████████████████████████████████████                                          | 67/100 [00:17<00:03,  9.47it/s]
INFO:     127.0.0.1:43344 - "POST /predict HTTP/1.1" 200 OK
 68%|██████████████████████████████████████████████████████████████████████████████████████▎                                        | 68/100 [00:17<00:03,  8.81it/s]
INFO:     127.0.0.1:43360 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43370 - "POST /predict HTTP/1.1" 200 OK
 70%|████████████████████████████████████████████████████████████████████████████████████████▉                                      | 70/100 [00:17<00:03,  9.33it/s]
INFO:     127.0.0.1:43374 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43390 - "POST /predict HTTP/1.1" 200 OK
 72%|███████████████████████████████████████████████████████████████████████████████████████████▍                                   | 72/100 [00:17<00:02,  9.90it/s]
INFO:     127.0.0.1:43400 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43414 - "POST /predict HTTP/1.1" 200 OK
 74%|█████████████████████████████████████████████████████████████████████████████████████████████▉                                 | 74/100 [00:17<00:02, 10.18it/s]
INFO:     127.0.0.1:43424 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43428 - "POST /predict HTTP/1.1" 200 OK
 76%|████████████████████████████████████████████████████████████████████████████████████████████████▌                              | 76/100 [00:18<00:02, 10.31it/s]
INFO:     127.0.0.1:43438 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43450 - "POST /predict HTTP/1.1" 200 OK
 78%|███████████████████████████████████████████████████████████████████████████████████████████████████                            | 78/100 [00:18<00:02,  9.57it/s]
INFO:     127.0.0.1:43456 - "POST /predict HTTP/1.1" 200 OK
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████▎                          | 79/100 [00:18<00:02,  8.91it/s]
INFO:     127.0.0.1:43460 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43476 - "POST /predict HTTP/1.1" 200 OK
 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                        | 81/100 [00:18<00:02,  9.50it/s]
INFO:     127.0.0.1:43482 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43492 - "POST /predict HTTP/1.1" 200 OK
 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▍                     | 83/100 [00:18<00:01,  9.08it/s]
INFO:     127.0.0.1:43494 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43504 - "POST /predict HTTP/1.1" 200 OK
 85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                   | 85/100 [00:19<00:01,  9.50it/s]
INFO:     127.0.0.1:43510 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43524 - "POST /predict HTTP/1.1" 200 OK
 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 87/100 [00:19<00:01,  9.83it/s]
INFO:     127.0.0.1:43538 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43542 - "POST /predict HTTP/1.1" 200 OK
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 89/100 [00:19<00:01, 10.20it/s]
INFO:     127.0.0.1:43554 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43558 - "POST /predict HTTP/1.1" 200 OK
 91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 91/100 [00:19<00:00,  9.38it/s]
INFO:     127.0.0.1:43562 - "POST /predict HTTP/1.1" 200 OK
 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊          | 92/100 [00:19<00:00,  8.74it/s]
INFO:     127.0.0.1:43572 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43576 - "POST /predict HTTP/1.1" 200 OK
 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 94/100 [00:20<00:00,  9.30it/s]
INFO:     127.0.0.1:43584 - "POST /predict HTTP/1.1" 200 OK
 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 95/100 [00:20<00:00,  8.52it/s]
INFO:     127.0.0.1:43590 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43606 - "POST /predict HTTP/1.1" 200 OK
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏   | 97/100 [00:20<00:00,  9.20it/s]
INFO:     127.0.0.1:43616 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:43620 - "POST /predict HTTP/1.1" 200 OK
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋ | 99/100 [00:20<00:00,  9.70it/s]
INFO:     127.0.0.1:43622 - "POST /predict HTTP/1.1" 200 OK
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:20<00:00,  4.81it/s]
Accuracy of step-000750 on Eval Dataset: 0.605
Processes on GPU 7: [226932]
Terminated process with PID: 226932 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 226905 richard  243u  IPv4 1600739      0t0  TCP *:8000 (LISTEN)

Port Process 226905 Killed
Killed

Evaluating step-000800
INFO:     Started server process [227149]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
  0%|                                                                                                                                        | 0/100 [00:00<?, ?it/s]
INFO:     127.0.0.1:54578 - "POST /predict HTTP/1.1" 200 OK
  1%|█▎                                                                                                                              | 1/100 [00:14<23:08, 14.03s/it]
INFO:     127.0.0.1:48698 - "POST /predict HTTP/1.1" 200 OK
  2%|██▌                                                                                                                             | 2/100 [00:14<09:32,  5.84s/it]
INFO:     127.0.0.1:48704 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38200 - "POST /predict HTTP/1.1" 200 OK
  4%|█████                                                                                                                           | 4/100 [00:14<03:35,  2.24s/it]
INFO:     127.0.0.1:38214 - "POST /predict HTTP/1.1" 200 OK
  5%|██████▍                                                                                                                         | 5/100 [00:14<02:29,  1.58s/it]
INFO:     127.0.0.1:38222 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38234 - "POST /predict HTTP/1.1" 200 OK
  7%|████████▉                                                                                                                       | 7/100 [00:14<01:21,  1.14it/s]
INFO:     127.0.0.1:38238 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38240 - "POST /predict HTTP/1.1" 200 OK
  9%|███████████▌                                                                                                                    | 9/100 [00:14<00:51,  1.77it/s]
INFO:     127.0.0.1:38252 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38266 - "POST /predict HTTP/1.1" 200 OK
 11%|█████████████▉                                                                                                                 | 11/100 [00:15<00:35,  2.52it/s]
INFO:     127.0.0.1:38282 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38284 - "POST /predict HTTP/1.1" 200 OK
 13%|████████████████▌                                                                                                              | 13/100 [00:15<00:25,  3.38it/s]
INFO:     127.0.0.1:38290 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38306 - "POST /predict HTTP/1.1" 200 OK
 15%|███████████████████                                                                                                            | 15/100 [00:15<00:20,  4.12it/s]
INFO:     127.0.0.1:38318 - "POST /predict HTTP/1.1" 200 OK
 16%|████████████████████▎                                                                                                          | 16/100 [00:15<00:18,  4.63it/s]
INFO:     127.0.0.1:38332 - "POST /predict HTTP/1.1" 200 OK
 17%|█████████████████████▌                                                                                                         | 17/100 [00:15<00:15,  5.23it/s]
INFO:     127.0.0.1:38344 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38360 - "POST /predict HTTP/1.1" 200 OK
 19%|████████████████████████▏                                                                                                      | 19/100 [00:15<00:12,  6.38it/s]
INFO:     127.0.0.1:38368 - "POST /predict HTTP/1.1" 200 OK
 20%|█████████████████████████▍                                                                                                     | 20/100 [00:16<00:12,  6.19it/s]
INFO:     127.0.0.1:38380 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38390 - "POST /predict HTTP/1.1" 200 OK
 22%|███████████████████████████▉                                                                                                   | 22/100 [00:16<00:10,  7.27it/s]
INFO:     127.0.0.1:38404 - "POST /predict HTTP/1.1" 200 OK
 23%|█████████████████████████████▏                                                                                                 | 23/100 [00:16<00:10,  7.23it/s]
INFO:     127.0.0.1:38414 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38426 - "POST /predict HTTP/1.1" 200 OK
 25%|███████████████████████████████▊                                                                                               | 25/100 [00:16<00:09,  8.23it/s]
INFO:     127.0.0.1:38430 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38438 - "POST /predict HTTP/1.1" 200 OK
 27%|██████████████████████████████████▎                                                                                            | 27/100 [00:16<00:08,  9.08it/s]
INFO:     127.0.0.1:38444 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38456 - "POST /predict HTTP/1.1" 200 OK
 29%|████████████████████████████████████▊                                                                                          | 29/100 [00:16<00:07,  9.37it/s]
INFO:     127.0.0.1:38472 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38474 - "POST /predict HTTP/1.1" 200 OK
 31%|███████████████████████████████████████▎                                                                                       | 31/100 [00:17<00:07,  9.82it/s]
INFO:     127.0.0.1:38476 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38492 - "POST /predict HTTP/1.1" 200 OK
 33%|█████████████████████████████████████████▉                                                                                     | 33/100 [00:17<00:06,  9.99it/s]
INFO:     127.0.0.1:38498 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38502 - "POST /predict HTTP/1.1" 200 OK
 35%|████████████████████████████████████████████▍                                                                                  | 35/100 [00:17<00:06,  9.96it/s]
INFO:     127.0.0.1:38516 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38530 - "POST /predict HTTP/1.1" 200 OK
 37%|██████████████████████████████████████████████▉                                                                                | 37/100 [00:17<00:06, 10.12it/s]
INFO:     127.0.0.1:38542 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38546 - "POST /predict HTTP/1.1" 200 OK
 39%|█████████████████████████████████████████████████▌                                                                             | 39/100 [00:17<00:06, 10.06it/s]
INFO:     127.0.0.1:38558 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38568 - "POST /predict HTTP/1.1" 200 OK
 41%|████████████████████████████████████████████████████                                                                           | 41/100 [00:18<00:05, 10.04it/s]
INFO:     127.0.0.1:38578 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38586 - "POST /predict HTTP/1.1" 200 OK
 43%|██████████████████████████████████████████████████████▌                                                                        | 43/100 [00:18<00:05, 10.03it/s]
INFO:     127.0.0.1:38594 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38598 - "POST /predict HTTP/1.1" 200 OK
 45%|█████████████████████████████████████████████████████████▏                                                                     | 45/100 [00:18<00:05, 10.04it/s]
INFO:     127.0.0.1:38608 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38618 - "POST /predict HTTP/1.1" 200 OK
 47%|███████████████████████████████████████████████████████████▋                                                                   | 47/100 [00:18<00:06,  8.67it/s]
INFO:     127.0.0.1:38624 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38636 - "POST /predict HTTP/1.1" 200 OK
 49%|██████████████████████████████████████████████████████████████▏                                                                | 49/100 [00:19<00:05,  9.08it/s]
INFO:     127.0.0.1:38652 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38666 - "POST /predict HTTP/1.1" 200 OK
 51%|████████████████████████████████████████████████████████████████▊                                                              | 51/100 [00:19<00:05,  9.60it/s]
INFO:     127.0.0.1:38668 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38682 - "POST /predict HTTP/1.1" 200 OK
 53%|███████████████████████████████████████████████████████████████████▎                                                           | 53/100 [00:19<00:04,  9.83it/s]
INFO:     127.0.0.1:38696 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38704 - "POST /predict HTTP/1.1" 200 OK
 55%|█████████████████████████████████████████████████████████████████████▊                                                         | 55/100 [00:19<00:04, 10.00it/s]
INFO:     127.0.0.1:38718 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38720 - "POST /predict HTTP/1.1" 200 OK
 57%|████████████████████████████████████████████████████████████████████████▍                                                      | 57/100 [00:19<00:04, 10.00it/s]
INFO:     127.0.0.1:38728 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38736 - "POST /predict HTTP/1.1" 200 OK
 59%|██████████████████████████████████████████████████████████████████████████▉                                                    | 59/100 [00:20<00:04,  9.97it/s]
INFO:     127.0.0.1:38752 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38768 - "POST /predict HTTP/1.1" 200 OK
 61%|█████████████████████████████████████████████████████████████████████████████▍                                                 | 61/100 [00:20<00:03, 10.07it/s]
INFO:     127.0.0.1:38778 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38784 - "POST /predict HTTP/1.1" 200 OK
 63%|████████████████████████████████████████████████████████████████████████████████                                               | 63/100 [00:20<00:03, 10.03it/s]
INFO:     127.0.0.1:38798 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38814 - "POST /predict HTTP/1.1" 200 OK
 65%|██████████████████████████████████████████████████████████████████████████████████▌                                            | 65/100 [00:20<00:03, 10.12it/s]
INFO:     127.0.0.1:38824 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38834 - "POST /predict HTTP/1.1" 200 OK
 67%|█████████████████████████████████████████████████████████████████████████████████████                                          | 67/100 [00:20<00:03, 10.21it/s]
INFO:     127.0.0.1:38844 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38846 - "POST /predict HTTP/1.1" 200 OK
 69%|███████████████████████████████████████████████████████████████████████████████████████▋                                       | 69/100 [00:20<00:03, 10.25it/s]
INFO:     127.0.0.1:38856 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38872 - "POST /predict HTTP/1.1" 200 OK
 71%|██████████████████████████████████████████████████████████████████████████████████████████▏                                    | 71/100 [00:21<00:02, 10.09it/s]
INFO:     127.0.0.1:38880 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38894 - "POST /predict HTTP/1.1" 200 OK
 73%|████████████████████████████████████████████████████████████████████████████████████████████▋                                  | 73/100 [00:21<00:02, 10.28it/s]
INFO:     127.0.0.1:38904 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38918 - "POST /predict HTTP/1.1" 200 OK
 75%|███████████████████████████████████████████████████████████████████████████████████████████████▎                               | 75/100 [00:21<00:02, 10.27it/s]
INFO:     127.0.0.1:38926 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38940 - "POST /predict HTTP/1.1" 200 OK
 77%|█████████████████████████████████████████████████████████████████████████████████████████████████▊                             | 77/100 [00:21<00:02, 10.16it/s]
INFO:     127.0.0.1:38948 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38962 - "POST /predict HTTP/1.1" 200 OK
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████▎                          | 79/100 [00:21<00:02, 10.41it/s]
INFO:     127.0.0.1:38964 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38966 - "POST /predict HTTP/1.1" 200 OK
 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████▊                        | 81/100 [00:22<00:01, 10.28it/s]
INFO:     127.0.0.1:38970 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:38982 - "POST /predict HTTP/1.1" 200 OK
 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▍                     | 83/100 [00:22<00:01,  9.25it/s]
INFO:     127.0.0.1:38990 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:39000 - "POST /predict HTTP/1.1" 200 OK
 85%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                   | 85/100 [00:22<00:01,  9.51it/s]
INFO:     127.0.0.1:39008 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:39012 - "POST /predict HTTP/1.1" 200 OK
 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 87/100 [00:22<00:01,  8.69it/s]
INFO:     127.0.0.1:39026 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:39036 - "POST /predict HTTP/1.1" 200 OK
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 89/100 [00:23<00:01,  9.15it/s]
INFO:     127.0.0.1:39050 - "POST /predict HTTP/1.1" 200 OK
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎            | 90/100 [00:23<00:01,  9.28it/s]
INFO:     127.0.0.1:39064 - "POST /predict HTTP/1.1" 200 OK
 91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌           | 91/100 [00:23<00:00,  9.41it/s]
INFO:     127.0.0.1:39078 - "POST /predict HTTP/1.1" 200 OK
 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊          | 92/100 [00:23<00:00,  8.28it/s]
INFO:     127.0.0.1:39080 - "POST /predict HTTP/1.1" 200 OK
 93%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████         | 93/100 [00:23<00:00,  8.62it/s]
INFO:     127.0.0.1:39096 - "POST /predict HTTP/1.1" 200 OK
 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 94/100 [00:23<00:00,  8.91it/s]
INFO:     127.0.0.1:39112 - "POST /predict HTTP/1.1" 200 OK
 95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋      | 95/100 [00:23<00:00,  7.67it/s]
INFO:     127.0.0.1:39128 - "POST /predict HTTP/1.1" 200 OK
 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 96/100 [00:23<00:00,  8.18it/s]
INFO:     127.0.0.1:39140 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:39156 - "POST /predict HTTP/1.1" 200 OK
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍  | 98/100 [00:24<00:00,  8.90it/s]
INFO:     127.0.0.1:39170 - "POST /predict HTTP/1.1" 200 OK
INFO:     127.0.0.1:33926 - "POST /predict HTTP/1.1" 200 OK
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:24<00:00,  4.11it/s]
Accuracy of step-000800 on Eval Dataset: 0.67
Processes on GPU 7: [227166]
Terminated process with PID: 227166 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 227149 richard  243u  IPv4 1600755      0t0  TCP *:8000 (LISTEN)

Port Process 227149 Killed
Killed

Evaluating step-000850
INFO:     Started server process [227383]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
  0%|                                                                                                                                        | 0/100 [00:00<?, ?it/s]
INFO:     127.0.0.1:33332 - "POST /predict HTTP/1.1" 504 Gateway Timeout
  0%|                                                                                                                                        | 0/100 [00:30<?, ?it/s]
Traceback (most recent call last):
  File "/data/richard/poker_llm/evaluate.py", line 58, in <module>
    model_response = response.json()['output'].split("Your optimal action is:")[1]
                     ~~~~~~~~~~~~~~~^^^^^^^^^^
KeyError: 'output'
Processes on GPU 7: [227410]
Terminated process with PID: 227410 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 227383 richard  243u  IPv4 1616739      0t0  TCP *:8000 (LISTEN)

Port Process 227383 Killed
Killed

^CTraceback (most recent call last):
  File "/data/richard/poker_llm/evaluate_all.py", line 76, in <module>
    time.sleep(10)
KeyboardInterrupt

(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python evaluate_all.py                                                                                                      130 ↵ richard@sn4622117596
['step-000700', 'step-000750', 'step-000800', 'step-000850', 'step-000900', 'step-000950', 'step-0001000', 'step-0001050', 'step-0001100', 'step-0001150', 'step-0001
200', 'step-0001250', 'step-0001300', 'step-0001350', 'step-0001400', 'step-0001450', 'step-0001500', 'step-0001550', 'step-0001600', 'step-0001650', 'step-0001700',
 'step-0001750', 'step-0001800', 'step-0001850', 'step-0001900', 'step-0001950', 'step-0002000', 'step-0002050', 'step-0002100', 'step-0002150', 'step-0002200', 'ste
p-0002250', 'step-0002300', 'step-0002350', 'step-0002400', 'step-0002450', 'step-0002500', 'step-0002550', 'step-0002600', 'step-0002650', 'step-0002700']
Evaluating step-000700
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:11<00:00,  8.61it/s]
Accuracy of step-000700 on Eval Dataset: 0.595
Processes on GPU 7: [228858]
Terminated process with PID: 228858 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 228831 richard  243u  IPv4 1621048      0t0  TCP *:8000 (LISTEN)

Port Process 228831 Killed
Evaluating step-000750
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:11<00:00,  8.90it/s]
Accuracy of step-000750 on Eval Dataset: 0.6
Processes on GPU 7: [229092]
Terminated process with PID: 229092 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 229065 richard  243u  IPv4 1629222      0t0  TCP *:8000 (LISTEN)

Port Process 229065 Killed
Evaluating step-000800
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:11<00:00,  8.76it/s]
Accuracy of step-000800 on Eval Dataset: 0.665
Processes on GPU 7: [229313]
Terminated process with PID: 229313 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 229286 richard  243u  IPv4 1630792      0t0  TCP *:8000 (LISTEN)

Port Process 229286 Killed
Evaluating step-000850
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:10<00:00,  9.45it/s]
Accuracy of step-000850 on Eval Dataset: 0.615
Processes on GPU 7: [230065]
Terminated process with PID: 230065 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 230038 richard  243u  IPv4 1631113      0t0  TCP *:8000 (LISTEN)

Port Process 230038 Killed
Evaluating step-000900
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:35<00:00,  2.85it/s]
Accuracy of step-000900 on Eval Dataset: 0.665
Processes on GPU 7: [230284]
Terminated process with PID: 230284 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 230257 richard  243u  IPv4 1632465      0t0  TCP *:8000 (LISTEN)

Port Process 230257 Killed
Evaluating step-000950
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:34<00:00,  2.94it/s]
Accuracy of step-000950 on Eval Dataset: 0.68
Processes on GPU 7: [230536]
Terminated process with PID: 230536 owned by richard
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 230502 richard  243u  IPv4 1645875      0t0  TCP *:8000 (LISTEN)

Port Process 230502 Killed
Evaluating step-0001000
^CTraceback (most recent call last):
  File "/data/richard/poker_llm/evaluate_all.py", line 20, in <module>
    time.sleep(30)
KeyboardInterrupt

(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python evaluate_all.py                                                                                                      130 ↵ richard@sn4622117596
['step-001000', 'step-001050', 'step-001100', 'step-001150', 'step-001200', 'step-001250', 'step-001300', 'step-001350', 'step-001400', 'step-001450', 'step-001500',
 'step-001550', 'step-001600', 'step-001650', 'step-001700', 'step-001750', 'step-001800', 'step-001850', 'step-001900', 'step-001950', 'step-002000', 'step-002050',
 'step-002100', 'step-002150', 'step-002200', 'step-002250', 'step-002300', 'step-002350', 'step-002400', 'step-002450', 'step-002500', 'step-002550', 'step-002600',
 'step-002650', 'step-002700', 'step-002750', 'step-002800', 'step-002850', 'step-002900', 'step-002950']
Evaluating step-001000
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:38<00:00,  2.59it/s]
Accuracy of step-001000 on Eval Dataset: 0.685
COMMAND      PID    USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
pt_main_t 230861 richard  243u  IPv4 1601080      0t0  TCP *:8000 (LISTEN)

Evaluating step-001050
  0%|                                                                                                                                        | 0/100 [00:00<?, ?it/s]
  0%|                                                                                                                                        | 0/100 [00:14<?, ?it/s]
Traceback (most recent call last):
  File "/data/richard/poker_llm/evaluate.py", line 50, in <module>
    response = requests.post(
               ^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/requests/api.py", line 115, in post
    return request("post", url, data=data, json=json, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/requests/api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/requests/adapters.py", line 486, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/urllib3/connectionpool.py", line 793, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/urllib3/connectionpool.py", line 537, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/site-packages/urllib3/connection.py", line 466, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/http/client.py", line 1395, in getresponse
    response.begin()
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/http/client.py", line 325, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/http/client.py", line 286, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Traceback (most recent call last):
  File "/data/richard/poker_llm/evaluate_all.py", line 23, in <module>
    eval_process.wait()
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/subprocess.py", line 1264, in wait
    return self._wait(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/subprocess.py", line 2053, in _wait
    (pid, sts) = self._try_wait(0)
                 ^^^^^^^^^^^^^^^^^
  File "/data/richard/miniconda3/envs/litgpt/lib/python3.11/subprocess.py", line 2011, in _try_wait
    (pid, sts) = os.waitpid(self.pid, wait_flags)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python evaluate_all.py                                                                                                      130 ↵ richard@sn4622117596
['step-001000', 'step-001050', 'step-001100', 'step-001150', 'step-001200', 'step-001250', 'step-001300', 'step-001350', 'step-001400', 'step-001450', 'step-001500',
 'step-001550', 'step-001600', 'step-001650', 'step-001700', 'step-001750', 'step-001800', 'step-001850', 'step-001900', 'step-001950', 'step-002000', 'step-002050',
 'step-002100', 'step-002150', 'step-002200', 'step-002250', 'step-002300', 'step-002350', 'step-002400', 'step-002450', 'step-002500', 'step-002550', 'step-002600',
 'step-002650', 'step-002700', 'step-002750', 'step-002800', 'step-002850', 'step-002900', 'step-002950']
Evaluating step-001000
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:15<00:00,  6.40it/s]
Accuracy of step-001000 on Eval Dataset: 0.685
Evaluating step-001050
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:14<00:00,  6.94it/s]
Accuracy of step-001050 on Eval Dataset: 0.655
Evaluating step-001100
  0%|                                                                                                                                        | 0/100 [00:30<?, ?it/s]
Traceback (most recent call last):
  File "/data/richard/poker_llm/evaluate.py", line 58, in <module>
    model_response = response.json()['output'].split("Your optimal action is:")[1]
                     ~~~~~~~~~~~~~~~^^^^^^^^^^
KeyError: 'output'
Evaluating step-001150
^CTraceback (most recent call last):
  File "/data/richard/poker_llm/evaluate_all.py", line 20, in <module>
    time.sleep(20)
KeyboardInterrupt

(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm »                                                                                                                             130 ↵ richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » lsof -i :8000                                                                                                               130 ↵ richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » nvidia-smi                                                                                                                    1 ↵ richard@sn4622117596
Sat May 25 16:58:37 2024
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.06              Driver Version: 545.23.06    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100 80GB PCIe          On  | 00000000:4F:00.0 Off |                    0 |
| N/A   69C    P0             282W / 300W |  74821MiB / 81920MiB |    100%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100 80GB PCIe          On  | 00000000:52:00.0 Off |                    0 |
| N/A   71C    P0             299W / 300W |  74801MiB / 81920MiB |    100%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100 80GB PCIe          On  | 00000000:56:00.0 Off |                    0 |
| N/A   30C    P0              54W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100 80GB PCIe          On  | 00000000:57:00.0 Off |                    0 |
| N/A   31C    P0              52W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA A100 80GB PCIe          On  | 00000000:D1:00.0 Off |                    0 |
| N/A   30C    P0              53W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA A100 80GB PCIe          On  | 00000000:D2:00.0 Off |                    0 |
| N/A   32C    P0              53W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA A100 80GB PCIe          On  | 00000000:D5:00.0 Off |                    0 |
| N/A   32C    P0              54W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA A100 80GB PCIe          On  | 00000000:D6:00.0 Off |                    0 |
| N/A   35C    P0              55W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+

+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|    0   N/A  N/A     45833      C   ...d/miniconda3/envs/litgpt/bin/python    77130MiB |
|    1   N/A  N/A     45858      C   ...d/miniconda3/envs/litgpt/bin/python    76336MiB |
+---------------------------------------------------------------------------------------+
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python evaluate_all.py                                                                                                            richard@sn4622117596
['step-001100', 'step-001150', 'step-001200', 'step-001250', 'step-001300', 'step-001350', 'step-001400', 'step-001450', 'step-001500', 'step-001550', 'step-001600',
 'step-001650', 'step-001700', 'step-001750', 'step-001800', 'step-001850', 'step-001900', 'step-001950', 'step-002000', 'step-002050', 'step-002100', 'step-002150',
 'step-002200', 'step-002250', 'step-002300', 'step-002350', 'step-002400', 'step-002450', 'step-002500', 'step-002550', 'step-002600', 'step-002650', 'step-002700',
 'step-002750', 'step-002800', 'step-002850', 'step-002900', 'step-002950']
Evaluating step-001100
^CTraceback (most recent call last):
  File "/data/richard/poker_llm/evaluate_all.py", line 20, in <module>
    time.sleep(30)
KeyboardInterrupt

(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » nvidia-smi                                                                                                                  130 ↵ richard@sn4622117596
Sat May 25 16:59:02 2024
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 545.23.06              Driver Version: 545.23.06    CUDA Version: 12.3     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA A100 80GB PCIe          On  | 00000000:4F:00.0 Off |                    0 |
| N/A   71C    P0             327W / 300W |  64443MiB / 81920MiB |    100%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA A100 80GB PCIe          On  | 00000000:52:00.0 Off |                    0 |
| N/A   73C    P0             342W / 300W |  65559MiB / 81920MiB |    100%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA A100 80GB PCIe          On  | 00000000:56:00.0 Off |                    0 |
| N/A   30C    P0              54W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA A100 80GB PCIe          On  | 00000000:57:00.0 Off |                    0 |
| N/A   31C    P0              52W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   4  NVIDIA A100 80GB PCIe          On  | 00000000:D1:00.0 Off |                    0 |
| N/A   30C    P0              53W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   5  NVIDIA A100 80GB PCIe          On  | 00000000:D2:00.0 Off |                    0 |
| N/A   32C    P0              53W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   6  NVIDIA A100 80GB PCIe          On  | 00000000:D5:00.0 Off |                    0 |
| N/A   32C    P0              54W / 300W |      4MiB / 81920MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   7  NVIDIA A100 80GB PCIe          On  | 00000000:D6:00.0 Off |                    0 |
| N/A   35C    P0              75W / 300W |  15459MiB / 81920MiB |      2%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+

+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|    0   N/A  N/A     45833      C   ...d/miniconda3/envs/litgpt/bin/python    65978MiB |
|    1   N/A  N/A     45858      C   ...d/miniconda3/envs/litgpt/bin/python    67094MiB |
|    7   N/A  N/A    232596      C   ...d/miniconda3/envs/litgpt/bin/python    15446MiB |
+---------------------------------------------------------------------------------------+
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » kill -9 232596                                                                                                                    richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » lsof -i :8000                                                                                                                     richard@sn4622117596
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » python evaluate_all.py                                                                                                        1 ↵ richard@sn4622117596
['step-001100', 'step-001150', 'step-001200', 'step-001250', 'step-001300', 'step-001350', 'step-001400', 'step-001450', 'step-001500', 'step-001550', 'step-001600',
 'step-001650', 'step-001700', 'step-001750', 'step-001800', 'step-001850', 'step-001900', 'step-001950', 'step-002000', 'step-002050', 'step-002100', 'step-002150',
 'step-002200', 'step-002250', 'step-002300', 'step-002350', 'step-002400', 'step-002450', 'step-002500', 'step-002550', 'step-002600', 'step-002650', 'step-002700',
 'step-002750', 'step-002800', 'step-002850', 'step-002900', 'step-002950']
Evaluating step-001100
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:13<00:00,  7.32it/s]
Accuracy of step-001100 on Eval Dataset: 0.695
Evaluating step-001150
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:32<00:00,  3.12it/s]
Accuracy of step-001150 on Eval Dataset: 0.685
Evaluating step-001200
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:24<00:00,  4.00it/s]
Accuracy of step-001200 on Eval Dataset: 0.705
Evaluating step-001250
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:31<00:00,  3.18it/s]
Accuracy of step-001250 on Eval Dataset: 0.72
Evaluating step-001300
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:34<00:00,  2.91it/s]
Accuracy of step-001300 on Eval Dataset: 0.685
Evaluating step-001350
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:31<00:00,  3.22it/s]
Accuracy of step-001350 on Eval Dataset: 0.695
Evaluating step-001400
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:31<00:00,  3.20it/s]
Accuracy of step-001400 on Eval Dataset: 0.675
Evaluating step-001450
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:23<00:00,  4.30it/s]
Accuracy of step-001450 on Eval Dataset: 0.68
Evaluating step-001500
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:37<00:00,  2.64it/s]
Accuracy of step-001500 on Eval Dataset: 0.725
Evaluating step-001550
  0%|                                                                                                                                        | 0/100 [00:30<?, ?it/s]
Traceback (most recent call last):
  File "/data/richard/poker_llm/evaluate.py", line 58, in <module>
    model_response = response.json()['output'].split("Your optimal action is:")[1]
                     ~~~~~~~~~~~~~~~^^^^^^^^^^
KeyError: 'output'
Evaluating step-001600
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:33<00:00,  2.96it/s]
Accuracy of step-001600 on Eval Dataset: 0.695
Evaluating step-001650
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:32<00:00,  3.09it/s]
Accuracy of step-001650 on Eval Dataset: 0.715
Evaluating step-001700
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:29<00:00,  3.38it/s]
Accuracy of step-001700 on Eval Dataset: 0.68
Evaluating step-001750
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:30<00:00,  3.27it/s]
Accuracy of step-001750 on Eval Dataset: 0.655
Evaluating step-001800
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:29<00:00,  3.41it/s]
Accuracy of step-001800 on Eval Dataset: 0.66
Evaluating step-001850
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:30<00:00,  3.28it/s]
Accuracy of step-001850 on Eval Dataset: 0.665
Evaluating step-001900
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:28<00:00,  3.47it/s]
Accuracy of step-001900 on Eval Dataset: 0.69
Evaluating step-001950
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:30<00:00,  3.33it/s]
Accuracy of step-001950 on Eval Dataset: 0.7
Evaluating step-002000
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:30<00:00,  3.32it/s]
Accuracy of step-002000 on Eval Dataset: 0.655
Evaluating step-002050
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:25<00:00,  3.87it/s]
Accuracy of step-002050 on Eval Dataset: 0.69
Evaluating step-002100
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:28<00:00,  3.47it/s]
Accuracy of step-002100 on Eval Dataset: 0.705
Evaluating step-002150
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:28<00:00,  3.45it/s]
Accuracy of step-002150 on Eval Dataset: 0.665
Evaluating step-002200
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:28<00:00,  3.52it/s]
Accuracy of step-002200 on Eval Dataset: 0.72
Evaluating step-002250
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:28<00:00,  3.50it/s]
Accuracy of step-002250 on Eval Dataset: 0.675
Evaluating step-002300
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:27<00:00,  3.61it/s]
Accuracy of step-002300 on Eval Dataset: 0.71
Evaluating step-002350
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:30<00:00,  3.32it/s]
Accuracy of step-002350 on Eval Dataset: 0.735
Evaluating step-002400
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:35<00:00,  2.79it/s]
Accuracy of step-002400 on Eval Dataset: 0.665
Evaluating step-002450
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:31<00:00,  3.22it/s]
Accuracy of step-002450 on Eval Dataset: 0.68
Evaluating step-002500
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:29<00:00,  3.34it/s]
Accuracy of step-002500 on Eval Dataset: 0.68
Evaluating step-002550
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:34<00:00,  2.94it/s]
Accuracy of step-002550 on Eval Dataset: 0.7
Evaluating step-002600
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:27<00:00,  3.59it/s]
Accuracy of step-002600 on Eval Dataset: 0.685
Evaluating step-002650
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:28<00:00,  3.53it/s]
Accuracy of step-002650 on Eval Dataset: 0.735
Evaluating step-002700
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:21<00:00,  4.67it/s]
Accuracy of step-002700 on Eval Dataset: 0.715
Evaluating step-002750
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:34<00:00,  2.87it/s]
Accuracy of step-002750 on Eval Dataset: 0.72
Evaluating step-002800
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:35<00:00,  2.84it/s]
Accuracy of step-002800 on Eval Dataset: 0.72
Evaluating step-002850
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:23<00:00,  4.29it/s]
Accuracy of step-002850 on Eval Dataset: 0.7
Evaluating step-002900
  0%|                                                                                                                                        | 0/100 [00:00<?, ?it/s]
^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:34<00:00,  2.87it/s]
Accuracy of step-002900 on Eval Dataset: 0.705
Evaluating step-002950
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:31<00:00,  3.22it/s]
Accuracy of step-002950 on Eval Dataset: 0.685
(litgpt) ------------------------------------------------------------------------------------------------------------------------------------------------------------
~/poker_llm » tmux capture-pane -p -S - -E - > eval_log.txt                                                                                     richard@sn4622117596

